!function o(s,n,a){function r(e,t){if(!n[e]){if(!s[e]){var i="function"==typeof require&&require;if(!t&&i)return i(e,!0);if(h)return h(e,!0);throw(i=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",i}i=n[e]={exports:{}},s[e][0].call(i.exports,function(t){return r(s[e][1][t]||t)},i,i.exports,o,s,n,a)}return n[e].exports}for(var h="function"==typeof require&&require,t=0;t<a.length;t++)r(a[t]);return r}({1:[function(t,e,i){"use strict";function o(t){requestAnimationFrame(function(){t.style.height="",t.style.height=+t.scrollHeight+"px"})}var s;s=jQuery,_,s.fn.ps_autosize=function(){return this.each(function(){o(this),s(this).off("input.ps-autosize").on("input.ps-autosize",function(){o(this)})})}},{}],2:[function(t,e,i){!function(n){!function(){"use strict";var t,i=(t="undefined"!=typeof window?window.jQuery:void 0!==n?n.jQuery:null)&&t.__esModule?t:{default:t},o="undefined"!=typeof window?window.peepso:void 0!==n?n.peepso:null,s="undefined"!=typeof window?window.peepsodata:void 0!==n?n.peepsodata:null;o.observer.addFilter("class_avatar_dialog",()=>e);class e{constructor(t={}){this.opts=t}init(){var t,e;this.$el||(e=(0,o.template)(s.avatar.templateDialog2||"")(this.opts.data),this.$el=(0,i.default)(e).hide(),this.$file=this.$el.find("input[type=file]"),this.$hasAvatar=this.$el.find(".ps-js-has-avatar"),this.$noAvatar=this.$el.find(".ps-js-no-avatar"),this.$preview=this.$el.find(".ps-js-preview"),this.$avatar=this.$el.find(".ps-js-avatar"),this.$loading=this.$el.find(".ps-js-loading"),this.$error=this.$el.find(".ps-js-error"),this.$btnRemove=this.$el.find(".ps-js-btn-remove"),this.$btnCrop=this.$el.find(".ps-js-btn-crop"),this.$btnCropCancel=this.$el.find(".ps-js-btn-crop-cancel"),this.$btnCropConfirm=this.$el.find(".ps-js-btn-crop-save"),this.$btnFinalize=this.$el.find(".ps-js-btn-finalize").attr("disabled","disabled"),this.$el.on("click",".ps-js-btn-upload",t=>this._onUpload(t)),this.$el.on("click",".ps-js-btn-remove",t=>this._onRemove(t)),this.$el.on("click",".ps-js-btn-crop",t=>this._onCrop(t)),this.$el.on("click",".ps-js-btn-crop-cancel",t=>this._onCropCancel(t)),this.$el.on("click",".ps-js-btn-crop-save",t=>this._onCropConfirm(t)),this.$el.on("click",".ps-js-btn-finalize",t=>this._onFinalize(t)),this.$el.on("click",".ps-js-btn-close",t=>this._onClose(t)),this.$el.appendTo(document.body),t=this.opts.data.avatar,e=this.opts.data.avatarSource,t&&e?this._updateAvatar(t,e):this._updateAvatar(!1),this._toggleError(!1),this._toggleLoading(!1),this._toggleFinalize(!1),t=this.opts.uploadUrl,e=i.default.extend({_wpnonce:s.avatar._wpnonce},this.opts.uploadParams),this.$file.psFileupload&&this.$file.psFileupload({url:t,formData:e,replaceFileInput:!1,dataType:"json",add:(t,e)=>{var i=e.files[0];this._toggleFinalize(!1),/(\.|\/)(jpe?g|png|webp)$/i.test(i.type)?parseInt(i.size)>s.upload.maxSize?this._toggleError(s.upload.textErrorMaxSize):(this._toggleLoading(!0),this._toggleError(!1),e.submit()):this._toggleError(s.avatar.textErrorFileType)},done:(t,e)=>{this._toggleLoading(!1);var i,o=e.result;o.success?(i=o.data&&o.data.image_url,e=o.data&&o.data.orig_image_url,this._updateAvatar(i,e),this._toggleFinalize(!0)):o.errors&&this._toggleError(o.errors)}}))}show(){this.init(),this.$el.show()}hide(){this.$el&&(this._toggleError(!1),this.$el.hide())}_updateAvatar(t,e){var i="?_t="+(new Date).getTime();t?(e&&this.$preview.find("img").attr("src",e+i),this.$avatar.find("img").attr("src",t+i),this.$btnRemove.show(),this.$noAvatar.hide(),this.$hasAvatar.show()):(this.$preview.find("img").removeAttr("src"),this.$avatar.find("img").attr("src",this.opts.data.avatarDefault+i),this.$btnRemove.hide(),this.$hasAvatar.hide(),this.$noAvatar.show())}_getCropCoord(){var t=this._cropCoords;if(!t)return!1;let e=this.$preview.find("img"),i=1,o=!1,s,n,a;return e[0].naturalWidth&&(s=e[0].naturalWidth||e.width(),n=e[0].naturalHeight||e.height(),(800<s||800<n)&&(i=800/Math.max(s,n),s*=i,n*=i,o=!0),i=s/e.width()),a={x1:Math.floor(i*t.x),y1:Math.floor(i*t.y),x2:Math.floor(i*(t.x+t.width)),y2:Math.floor(i*(t.y+t.height))},o&&(a.width=s,a.height=n),a}_toggleError(t){(t=t instanceof Array?t.join("<br>"):t)?(this.$error.html(t),this.$error.show()):(this.$error.hide(),this.$error.html(""))}_toggleLoading(t){t?this.$loading.stop().show():this.$loading.stop().fadeOut()}_toggleFinalize(t){t?this.$btnFinalize.removeAttr("disabled"):this.$btnFinalize.attr("disabled","disabled")}_onUpload(t){t.preventDefault(),t.stopPropagation(),this.$file.click()}_onCrop(t){t.preventDefault(),t.stopPropagation();t=this.$preview.find("img");ps_crop.init({elem:t,change:t=>{this._cropCoords=t}}),this.$btnCrop.hide(),this.$btnCropCancel.show(),this.$btnCropConfirm.show(),this._toggleFinalize(!1)}_onCropCancel(t){t.preventDefault(),t.stopPropagation();t=this.$preview.find("img");ps_crop.detach(t),this.$btnCrop.show(),this.$btnCropCancel.hide(),this.$btnCropConfirm.hide()}_onCropConfirm(t){t.preventDefault(),t.stopPropagation();var e=this.$preview.find("img");ps_crop.detach(e),this.$btnCrop.show(),this.$btnCropCancel.hide(),this.$btnCropConfirm.hide();t=this._getCropCoord(),e={x:t.x1,y:t.y1,x2:t.x2,y2:t.y2,width:t.width,height:t.height,tmp:1},t=this.opts.cropUrl,e=i.default.extend({_wpnonce:s.avatar._wpnonce},e,this.opts.cropParams);this._toggleLoading(!0),peepso.postJson(t,e,t=>{this._toggleLoading(!1),t.success&&(t=t.data.image_url,this._updateAvatar(t),this._toggleFinalize(!0))})}_onRemove(t){t.preventDefault(),t.stopPropagation();var e=this.opts.deleteUrl,t=i.default.extend({_wpnonce:s.avatar._wpnonce},this.opts.deleteParams);this._toggleLoading(!0),peepso.postJson(e,t,t=>{this._toggleLoading(!1),t.success&&window.loading.reload()})}_onFinalize(t){t.preventDefault(),t.stopPropagation();var e=this.opts.confirmUrl,t=i.default.extend({_wpnonce:s.avatar._wpnonce},this.opts.confirmParams);this._toggleLoading(!0),peepso.postJson(e,t,t=>{this._toggleLoading(!1),t.success&&window.location.reload()})}_onClose(t){t.preventDefault(),t.stopPropagation(),this.hide()}}}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(t,e,i){!function(s){!function(){"use strict";var t,i=(t="undefined"!=typeof window?window.jQuery:void 0!==s?s.jQuery:null)&&t.__esModule?t:{default:t},o="undefined"!=typeof window?window.peepso:void 0!==s?s.peepso:null;o.observer.addFilter("class_avatar",()=>e);class e{constructor(t,e={}){this.opts=e,this.dialog=null,this.$el=(0,i.default)(t),this.$button=this.$el.find(".ps-js-focus-avatar-button"),this.$button.on("click",t=>this._onModify(t))}getDialog(){if(null!==this.dialog)return this.dialog;let t=o.observer.applyFilters("class_avatar_dialog",!1);if(!1===t)return this.dialog=!1,this.dialog;var e=i.default.extend({},this.opts,{onChange:t=>this.updateAvatar(t)});return this.dialog=new t(e),this.dialog}showDialog(){let t=this.getDialog();t&&t.show()}updateAvatar(t){}_onModify(t){t.preventDefault(),this.showDialog()}}}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],4:[function(t,e,i){"use strict";t("./avatar"),t("./avatar-dialog")},{"./avatar":3,"./avatar-dialog":2}],5:[function(t,e,i){!function(n){!function(){"use strict";var t,i=(t="undefined"!=typeof window?window.jQuery:void 0!==n?n.jQuery:null)&&t.__esModule?t:{default:t},o="undefined"!=typeof window?window.peepso:void 0!==n?n.peepso:null,s="undefined"!=typeof window?window.peepsodata:void 0!==n?n.peepsodata:null;o.observer.addFilter("class_cover_dialog",()=>e);class e{constructor(t={}){this.opts=t}init(){var t,e;this.$el||(e=(0,o.template)(s.cover.templateDialog||"")(),this.$el=(0,i.default)(e).hide(),this.$file=this.$el.find("input[type=file]"),this.$content=this.$el.find(".ps-js-content"),this.$loading=this.$el.find(".ps-js-loading"),this.$error=this.$el.find(".ps-js-error"),this.$el.on("click",".ps-js-btn-upload",t=>this._onUpload(t)),this.$el.on("click",".ps-js-btn-remove",t=>this._onRemove(t)),this.$el.on("click",".ps-js-btn-close",t=>this._onClose(t)),this.$el.appendTo(document.body),this._toggleRemove(this.opts.data&&this.opts.data.cover),this._toggleError(!1),this._toggleLoading(!1),t=this.opts.uploadUrl,e=i.default.extend({_wpnonce:s.cover._wpnonce},this.opts.uploadParams),this.$file.psFileupload&&this.$file.psFileupload({url:t,formData:e,replaceFileInput:!1,dataType:"json",add:(t,e)=>{var i=e.files[0];/(\.|\/)(jpe?g|png|webp)$/i.test(i.type)?parseInt(i.size)>s.upload.maxSize?this._toggleError(s.upload.textErrorMaxSize):(this._toggleLoading(!0),this._toggleError(!1),e.submit()):this._toggleError(s.cover.textErrorFileType)},done:(t,e)=>{this._toggleLoading(!1);e=e.result;e.success&&(this._toggleRemove(!0),this.hide(),"function"!=typeof this.opts.onChange||(e=e.data&&e.data.image_url)&&this.opts.onChange(e))}}))}show(){this.init(),this.$el.show()}hide(){this.$el&&this.$el.hide()}_toggleError(t){t?(this.$error.html(t),this.$error.show()):(this.$error.hide(),this.$error.html(""))}_toggleLoading(t){t?(this.$content.hide(),this.$loading.show()):(this.$loading.hide(),this.$content.show())}_toggleRemove(t){t?(this.$content.addClass("ps-list-half"),this.$content.find(".ps-js-li-remove").show()):(this.$content.removeClass("ps-list-half"),this.$content.find(".ps-js-li-remove").hide())}_onUpload(t){t.preventDefault(),t.stopPropagation(),this.$file.click()}_onRemove(t){t.preventDefault(),t.stopPropagation();var e=this.opts.deleteUrl,t=i.default.extend({_wpnonce:s.cover._wpnonce},this.opts.deleteParams);this._toggleLoading(!0),peepso.postJson(e,t,t=>{this._toggleLoading(!1),t.success&&(this._toggleRemove(!1),this.hide(),"function"==typeof this.opts.onChange&&this.opts.onChange(!1))})}_onClose(t){t.preventDefault(),t.stopPropagation(),this.hide()}}}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],6:[function(t,e,i){!function(n){!function(){"use strict";var t,i=(t="undefined"!=typeof window?window.jQuery:void 0!==n?n.jQuery:null)&&t.__esModule?t:{default:t},o="undefined"!=typeof window?window.peepso:void 0!==n?n.peepso:null,s="undefined"!=typeof window?window.peepsodata:void 0!==n?n.peepsodata:null;o.observer.addFilter("class_cover",()=>e);class e{constructor(t,e={}){this.opts=e,this.dialog=null,this.$el=(0,i.default)(t),this.$image=this.$el.find(".ps-js-cover-image"),this.$btnModify=this.$el.find(".ps-js-cover-modify"),this.$btnReposition=this.$el.find(".ps-js-cover-reposition"),this.$btnRepositionCancel=this.$el.find(".ps-js-cover-reposition-cancel"),this.$btnRepositionSave=this.$el.find(".ps-js-cover-reposition-save"),this.$btnModify.on("click",t=>this._onModify(t)),this.$btnReposition.on("click",t=>this._onReposition(t)),this.$btnRepositionCancel.on("click",t=>this._onRepositionCancel(t)),this.$btnRepositionSave.on("click",t=>this._onRepositionSave(t)),this.imageStyle=this.$image.attr("style"),this.imagePositionX=this.$image.css("left"),this.imagePositionY=this.$image.css("top")}getDialog(){if(null!==this.dialog)return this.dialog;let t=o.observer.applyFilters("class_cover_dialog",!1);if(!1===t)return this.dialog=!1,this.dialog;var e=i.default.extend({},this.opts,{onChange:t=>this.updateCover(t)});return this.dialog=new t(e),this.dialog}showDialog(){let t=this.getDialog();t&&t.show()}updateCover(t){t?(this.$image.css({top:0,left:0}),this.$image.attr("src",t),this._toggleReposition(!0)):window.location.reload()}_toggleReposition(t){t?this.$btnReposition.show():this.$btnReposition.hide()}_toggleRepositioning(t){t?(this.$el.find(".js-focus-gradient").hide(),this.$el.find(".js-focus-change-cover > a").hide(),this.$el.find(".reposition-cover-actions").show(),this.$el.addClass("ps-focus-cover-edit")):(this.$el.find(".js-focus-gradient").show(),this.$el.find(".js-focus-change-cover > a").show(),this.$el.find(".reposition-cover-actions").hide(),this.$el.removeClass("ps-focus-cover-edit"))}_onModify(t){t.preventDefault(),this.showDialog()}_onReposition(t){t.preventDefault(),this._toggleRepositioning(!0);let i=this.$el.height()-this.$image.height(),o=this.$el.width()-this.$image.width();this.$image.draggable({cursor:"move",drag:function(t,e){e.position.left=Math.max(o,Math.min(0,e.position.left)),e.position.top=Math.max(i,Math.min(0,e.position.top))},stop:(t,e)=>{var i=100*e.position.left/this.$el.width(),e=100*e.position.top/this.$el.height(),i=Math.round(1e4*i)/1e4,e=Math.round(1e4*e)/1e4;this.imagePositionX=i,this.imagePositionY=e,this.$image.css({left:`${i}%`,top:`${e}%`})}})}_onRepositionCancel(t){t.preventDefault(),t.stopPropagation(),this._toggleRepositioning(!1),this.$image.attr("style",this.imageStyle),this.$image.draggable("destroy")}_onRepositionSave(t){t.preventDefault(),t.stopPropagation();var e=this.opts.repositionUrl,t={_wpnonce:s.cover._wpnonce,x:this.imagePositionY,y:this.imagePositionX};this._toggleRepositioning(!1),this.$el.find(".ps-reposition-loading").show(),t=i.default.extend(t,this.opts.repositionParams),peepso.postJson(e,t,t=>{this.$el.find(".ps-reposition-loading").hide(),this.imageStyle=this.$image.attr("style"),this.$image.draggable("destroy")})}}}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],7:[function(t,e,i){"use strict";t("./cover"),t("./cover-dialog")},{"./cover":6,"./cover-dialog":5}],8:[function(t,e,n){!function(i){!function(){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var t,r=(t="undefined"!=typeof window?window.jQuery:void 0!==i?i.jQuery:null)&&t.__esModule?t:{default:t};function h(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}const l=["January","February","March","April","May","June","July","August","September","October","November","December"];const c=(t,e)=>{let i=new Date(t,e,0);return i.getDate()},o=t=>{t=t.split("-");return new Date(+t[0],+t[1]-1,+t[2])},s=t=>{let e=t.getFullYear(),i=t.getMonth()+1,o=t.getDate();return[e,(i<10?"0":"")+i,(o<10?"0":"")+o].join("-")};var e=class{constructor(t,e,i,o={}){h(this,"$year",void 0),h(this,"$month",void 0),h(this,"$date",void 0),h(this,"opts",void 0);let s=new Date,n=s.getFullYear(),a={monthNames:l,defaultDate:new Date(s.getTime()),minDate:new Date(n-80,0,1,1,0,0),maxDate:new Date(n+80,11,31,1,0,0),onSelect:()=>{}};this.opts=r.default.extend(a,o),this.$year=(0,r.default)(t).on("change",t=>this.onChangeYear(t)),this.$month=(0,r.default)(e).on("change",t=>this.onChangeMonth(t)),this.$date=(0,r.default)(i).on("change",()=>this.onChangeDate()),this.populateYear(),this.populateMonth(+this.$year.val()),this.populateDate(+this.$year.val(),+this.$month.val())}getDate(t=!1){var e=+this.$date.val(),i=+this.$month.val(),o=+this.$year.val();return t?`${e} ${l[i-1]} ${o}`:s(new Date(o,i-1,e))}setDate(t){var e=(t="string"==typeof t?o(t):t).getDate(),i=t.getMonth()+1,t=t.getFullYear();this.populateYear(t),this.populateMonth(t,i),this.populateDate(t,i,e)}populateYear(t){let{minDate:e,maxDate:i,defaultDate:o}=this.opts,s=e.getFullYear(),n=i.getFullYear(),a="";for(t=t||o.getFullYear();s<=n;s++)a+=`<option value="${s}"${s===t?' selected="selected"':""}>${s}</option>`;this.$year.html(a)}populateMonth(t,e){let{minDate:i,maxDate:o,defaultDate:s,monthNames:n}=this.opts,a=i.getFullYear(),r=o.getFullYear(),h=a<t?1:i.getMonth()+1,l=t<r?12:o.getMonth()+1,d="";for(e=e||(+this.$month.val()||s.getMonth()+1);h<=l;h++)d+=`<option value="${h}"${h===e?' selected="selected"':""}>${n[h-1]}</option>`;this.$month.html(d)}populateDate(t,e,i){let{minDate:o,maxDate:s,defaultDate:n}=this.opts,a=o.getFullYear(),r=s.getFullYear(),h=o.getMonth()+1,l=s.getMonth()+1,d=a<t||h<e?1:o.getDate(),p=t<r||e<l?c(t,e):s.getDate(),u="";for(i=i||((i=+this.$date.val())?Math.min(i,p):n.getDate());d<=p;d++)u+=`<option value="${d}"${d===i?' selected="selected"':""}>${d}</option>`;this.$date.html(u)}onChangeYear(t){t=+t.target.value;this.populateMonth(t),this.$month.triggerHandler("change")}onChangeMonth(t){var e=+this.$year.val(),t=+t.target.value;this.populateDate(e,t),this.$date.triggerHandler("change")}onChangeDate(){this.opts.onSelect(this.getDate())}};n.default=e}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],9:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),Object.defineProperty(i,"DateSelector",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(i,"TimeSelector",{enumerable:!0,get:function(){return s.default}});var o=n(t("./date-selector")),s=n(t("./time-selector"));function n(t){return t&&t.__esModule?t:{default:t}}},{"./date-selector":8,"./time-selector":10}],10:[function(t,e,r){!function(i){!function(){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var t,s=(t="undefined"!=typeof window?window.jQuery:void 0!==i?i.jQuery:null)&&t.__esModule?t:{default:t};function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}const o=(t,e)=>t="PM"!==e.toUpperCase()?12===t?0:t:12===t?12:t+12,a=t=>{let e;return{hour:t=t<12?(e="AM",0===t?12:t):(e="PM",12===t?12:t-12),ampm:e}};var e=class{constructor(t,e,i,o){n(this,"$hour",void 0),n(this,"$minute",void 0),n(this,"$ampm",void 0),n(this,"opts",void 0),n(this,"isAmpm",void 0);this.isAmpm=!(!i||!i.nodeType),this.opts=s.default.extend({am:"AM",pm:"PM",step:15,onSelect:()=>{}},(this.isAmpm?o:i)||{}),this.$hour=(0,s.default)(t).on("change",()=>this.onChangeHour()),this.$minute=(0,s.default)(e).on("change",()=>this.onChangeMinute()),this.isAmpm&&(this.$ampm=(0,s.default)(i).on("change",()=>this.onChangeAmpm())),this.populateHour(),this.populateMinute(),this.populateAmpm()}getTime(t=!1){let e=+this.$hour.val(),i=+this.$minute.val();return t?`${e<10?"0":""}${e}:${i<10?"0":""}${i}${this.isAmpm?" "+this.$ampm.val().toUpperCase():""}`:(this.isAmpm&&(e=o(e,this.$ampm.val())),`${e<10?"0":""}${e}:${i<10?"0":""}${i}`)}setTime(t){let[e,i]=t.split(":");e=+e,this.isAmpm?(e=a(e),this.$ampm.val(e.ampm),this.$hour.val(e.hour)):this.$hour.val(e),i=Math.min(59,Math.max(0,+i)),i-=i%this.opts.step,this.$minute.val(i)}populateHour(t){let e=this.isAmpm?1:0,i=this.isAmpm?12:23,o="";for(;e<=i;e++)o+=`<option value="${e}"${e===t?' selected="selected"':""}>${e<10?"0":""}${e}</option>`;this.$hour.html(o)}populateMinute(t){let e=0,i="";for(;e<=59;e+=this.opts.step)i+=`<option value="${e}"${e===t?' selected="selected"':""}>${e<10?"0":""}${e}</option>`;this.$minute.html(i)}populateAmpm(o){if(this.isAmpm){let e=[{value:"AM",label:this.opts.am},{value:"PM",label:this.opts.pm}],i="";for(let t=0;t<e.length;t++)i+=`<option value="${e[t].value}"${e[t].value===o?' selected="selected"':""}>${e[t].label||e[t].value}</option>`;this.$ampm.html(i)}}onChangeHour(){this.opts.onSelect(this.getTime())}onChangeMinute(){this.opts.onSelect(this.getTime())}onChangeAmpm(){this.opts.onSelect(this.getTime())}};r.default=e}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],11:[function(t,e,i){"use strict";function o(t){var e=n(t.currentTarget).closest(".ps-js-dropdown"),i=e.find(".ps-js-dropdown-menu"),o=n(document),s=e.data("ps-guid");if(t.preventDefault(),s||(s=_.uniqueId("ps-dropdown-"),e.data("ps-guid",s)),i.is(":visible"))return t.stopPropagation(),o.off("click."+s),void i.hide();i.show(),o.one("click."+s,function(){i.hide()})}function s(t){var e="[class*=gci-]",i=".ps-js-dropdown-label",o=n(t.currentTarget),s=o.closest(".ps-js-dropdown"),t=s.find(".ps-js-dropdown-toggle");s.hasClass("ps-js-dropdown--privacy")&&((s=s.children("[type=hidden]")).val(o.data("option-value")),s.triggerHandler("change"),t.find(e).attr("class",o.find(e).attr("class")),t.find(i).html(o.find(i).html()))}var n;(n=jQuery)(function(){n(document).on("click.ps-dropdown",".ps-js-dropdown-menu a",s).on("click.ps-dropdown",".ps-js-dropdown-toggle",o)})},{}],12:[function(t,e,o){!function(i){!function(){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var a=t("undefined"!=typeof window?window.jQuery:void 0!==i?i.jQuery:null),r=t("undefined"!=typeof window?window._:void 0!==i?i._:null);function t(t){return t&&t.__esModule?t:{default:t}}function e(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}const h="ps-focus-area-footer";o.default=class{constructor(t){e(this,"$footer",void 0),e(this,"$interactions",void 0),e(this,"$menu",void 0),e(this,"$menuInner",void 0),e(this,"$menuItems",void 0),e(this,"$menuMore",void 0),e(this,"$menuDropdown",void 0),e(this,"toggleAid",r.default.throttle(()=>{let t=!1,e=!1;var i,o,s;this.isNarrow()&&(i=this.$menuInner.scrollLeft(),o=this.$menuInner[0].scrollWidth,s=this.$menuInner[0].clientWidth,t=0<i,e=i+s<o),t?this.$menuAidLeft.show():this.$menuAidLeft.hide(),e?this.$menuAidRight.show():this.$menuAidRight.hide()},250)),this.$footer=(0,a.default)(t),this.$interactions=this.$footer.find(".ps-js-focus-interactions"),this.$menu=this.$footer.find(".ps-js-focus__menu"),this.$menuInner=this.$menu.find(".ps-js-focus__menu-inner"),this.$menuItems=this.$menu.find(".ps-js-item"),this.$menuMore=this.$menu.find(".ps-js-item-more"),this.$menuDropdown=this.$menu.find(".ps-js-focus-link-dropdown"),this.$menuAidLeft=this.$menu.find(".ps-js-aid-left"),this.$menuAidRight=this.$menu.find(".ps-js-aid-right"),this.centerActiveMenu(),r.default.defer(()=>this.rearrange()),(0,a.default)(window).on(`resize.${h}`,r.default.debounce(()=>this.rearrange(),1e3))}isNarrow(){return window.innerWidth<=740}hasTouch(){return"ontouchstart"in window||0<navigator.msMaxTouchPoints}centerActiveMenu(){if(this.isNarrow()){let s=this.$menuItems.filter(".ps-js-item-active");if(s.length){let t=this.$menuInner,e=t.width(),i=s.position().left,o=s.width();t.scrollLeft(i-(e-o)/2)}}}reset(){this.$menuDropdown.hide().empty(),this.$menuMore.detach().off("click"),this.$menuItems.css("display",""),this.detachScroller(),this.$menuInner.off("scroll").on("scroll",()=>this.toggleAid()),this.toggleAid()}rearrange(){if(this.reset(),this.isNarrow())this.hasTouch()||this.attachScroller();else{let t=this.$menu.width(),e=0,i,o;for(;++e<=20&&(i=this.$menuItems.filter(":visible").last(),o=1===e?i:this.$menuMore,!(peepso.rtl&&0<=o.position().left))&&(peepso.rtl||!(Math.floor(o.position().left+o.outerWidth())<=t));)1===e&&(this.$menuMore.insertBefore(this.$menuDropdown.parent()),this.$menuMore.show(),this.$menuMore.on("click",t=>{t.preventDefault(),t.stopPropagation(),this.toggleDropdown()})),i=i.hide().clone(),this.$menuDropdown.prepend(i.css("display",""))}}toggleDropdown(){let t=(0,a.default)(document),e=`click.${h}`;this.$menuDropdown.is(":visible")?(this.$menuDropdown.hide(),t.off(e)):(this.$menuDropdown.show(),t.one(e,()=>this.$menuDropdown.hide()))}attachScroller(){let t=!1,i=!1,o,s,n;this.$menuInner.on("mousedown mouseup mousemove mouseleave",function(e){if(e.preventDefault(),e.stopPropagation(),"mousedown"===e.type)t=!0,i=!1,o=[e.clientX,e.clientY];else if("mousemove"==e.type&&t){let t=(0,a.default)(this);s=[e.clientX,e.clientY],n=[s[0]-o[0],s[1]-o[1]],t.scrollLeft(t.scrollLeft()-n[0]),t.scrollTop(t.scrollTop()-n[1]),o=[e.clientX,e.clientY],i=!0}else if(("mouseup"===e.type||"mouseleave"===e.type)&&(t=!1,i)){let t=(0,a.default)(e.target).closest("a");t.length&&(t.on(`click.${h}`,t=>t.preventDefault()),r.default.defer(()=>t.off(`click.${h}`)))}})}detachScroller(){this.$menuInner.off("mousedown mouseup mousemove mouseleave")}}}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],13:[function(a,t,r){!function(n){!function(){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var e=t("undefined"!=typeof window?window.jQuery:void 0!==n?n.jQuery:null),i="undefined"!=typeof window?window.peepso:void 0!==n?n.peepso:null,o=t(a("./focus-area-footer"));function t(t){return t&&t.__esModule?t:{default:t}}function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}r.default=class{constructor(t){s(this,"$container",void 0),s(this,"$avatar",void 0),s(this,"$footer",void 0),s(this,"footer",void 0),this.$container=(0,e.default)(t),this.$avatar=this.$container.find(".ps-js-focus-avatar-button"),this.$footer=this.$container.find(".ps-focus__footer"),this.$avatar.length&&this.$avatar.on("click",t=>this.onClickAvatar(t)),this.$footer.length&&(this.footer=new o.default(this.$footer[0])),i.observer.addAction("avatar_updated",t=>this.onAvatarUpdated(t),10,1)}onClickAvatar(t){t.preventDefault(),t.stopPropagation(),i.observer.doAction("avatar_update_dialog")}onAvatarUpdated(t){}}}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./focus-area-footer":12}],14:[function(t,e,i){"use strict";var o,s=(o=t("./focus-area"))&&o.__esModule?o:{default:o};document.addEventListener("DOMContentLoaded",function(){var t=document.querySelector(".ps-js-focus");t&&new s.default(t)})},{"./focus-area":13}],15:[function(t,e,f){!function(c){!function(){"use strict";Object.defineProperty(f,"__esModule",{value:!0}),f.default=void 0;var s=t("undefined"!=typeof window?window.jQuery:void 0!==c?c.jQuery:null),n=(t("undefined"!=typeof window?window._:void 0!==c?c._:null),function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};e=a(e);if(e&&e.has(t))return e.get(t);var i,o={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(i in t){var n;"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&((n=s?Object.getOwnPropertyDescriptor(t,i):null)&&(n.get||n.set)?Object.defineProperty(o,i,n):o[i]=t[i])}o.default=t,e&&e.set(t,o);return o}("undefined"!=typeof window?window.peepso:void 0!==c?c.peepso:null)),e="undefined"!=typeof window?window.peepsodata:void 0!==c?c.peepsodata:null;function a(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,i=new WeakMap;return(a=function(t){return t?i:e})(t)}function t(t){return t&&t.__esModule?t:{default:t}}function i(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}let r,h,l;function d(t,o){if(clearTimeout(l),r=r||(h=(0,s.default)("<div />").append(e.hovercard.template),h.css({position:"absolute"}),r=(0,s.default)("<div />").css({display:"none",height:1,overflow:"visible",position:"absolute",width:1,zIndex:100001}),r.on("mouseenter touchstart",function(t){t.stopPropagation(),d()}),r.on("mouseleave",function(t){t.stopPropagation(),p()}),r.append(h).appendTo(document.body),r),"loading"===t?r.find(".ps-js-loading").show():t&&(r.find(".ps-js-loading").hide(),r.find(".ps-js-name").html(t.name),r.find(".ps-js-avatar").attr("src",t.avatar),r.find(".ps-js-cover").css({backgroundImage:`url(${encodeURI(t.cover)})`}),r.find(".ps-js-views").html(t.views||0),r.find(".ps-js-likes").html(t.likes||0),r.find(".ps-js-link").attr("href",t.link||"#"),n.observer.doAction("hovercard_update_html",r,t)),r.show(),n.default.isTouch()&&(0,s.default)(document).off("touchstart.hovercard").one("touchstart.hovercard",p),o&&o.currentTarget&&o.clientX){let t=(0,s.default)(o.currentTarget),e=t.offset(),i=window.innerWidth<=480;h.css({top:"",left:0,bottom:0,right:i?0:""}),r.css({top:e.top-r.height(),left:i?0:o.clientX,right:i?0:"",width:i?"":1});o=h.get(0).getBoundingClientRect();o.top<0&&(r.css({top:e.top+t.height()}),h.css({bottom:"",top:0})),i||o.right>(window.innerWidth||document.documentElement.clientWidth)&&h.css({left:"",right:0})}}function p(){r&&(l=setTimeout(function(){r.hide(),n.default.isTouch()&&(0,s.default)(document).off("touchstart.hovercard")},200))}class u{constructor(t,e){i(this,"$elem",void 0),i(this,"id",void 0),i(this,"data",void 0),i(this,"timer",void 0),this.id=e,this.$elem=(0,s.default)(t),this.$elem.on("mouseenter touchstart",t=>{t.stopPropagation(),this.show(t)}),this.$elem.on("mouseleave",t=>{t.stopPropagation(),this.hide()}),n.default.isTouch()&&this.$elem.on("click",t=>{t.preventDefault(),t.stopPropagation()}),n.observer.addAction("profile_update_like",(t,e)=>{if(+t==+this.id){let t=u.cache[this.id];t&&(t.likes=e)}},10,2)}getData(){return new n.Promise((e,i)=>{let o=u.cache[this.id];o?e(o):n.default.postJson("hovercard.info",{userid:this.id},t=>{t.success?(o=u.cache[this.id]=t.data,e(o)):i()})})}show(i){this.timer=setTimeout(()=>{let e=setTimeout(()=>{d("loading",i)},500);this.getData().then(t=>{clearTimeout(e),this.timer&&d(t,i)})},300)}hide(){clearTimeout(this.timer),this.timer=null,p()}}i(u,"cache",{});var o=u;f.default=o,(0,s.default)(function(){e.hovercard&&(0,s.default)(document).on("mouseenter touchstart","[data-hover-card]",function(i){let o=(0,s.default)(i.currentTarget);if(!o.data("ps-hovercard")){let t=o.data("hover-card"),e=new u(o[0],t);o.data("ps-hovercard",e),e.show(i)}})})}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],16:[function(t,e,i){"use strict";t("./autosize"),t("./dropdown"),t("./share"),t("./time"),t("./safety-warning"),t("./posttabs"),t("./postbox-legacy"),t("./postbox"),t("./notification-general"),t("./widgets"),t("./third-party-fixes"),t("./lightbox"),t("./focus-area"),t("./hover-card"),t("./cover"),t("./avatar/index")},{"./autosize":1,"./avatar/index":4,"./cover":7,"./dropdown":11,"./focus-area":14,"./hover-card":15,"./lightbox":17,"./notification-general":18,"./postbox":23,"./postbox-legacy":22,"./posttabs":28,"./safety-warning":29,"./share":30,"./third-party-fixes":31,"./time":32,"./widgets":33}],17:[function(f,t,e){!function(c){!function(){"use strict";var t,o,s,e,i,n,a,r,h="undefined"!=typeof window?window.peepso:void 0!==c?c.peepso:null,l=p(f("imagesloaded")),d=p(f("swipejs"));function p(t){return t&&t.__esModule?t:{default:t}}function u(){}t=jQuery||$,d=d.default,a=new(o=t,s=d,e=peepsolightboxdata.template.replace(/>\s+</g,"><"),i="ps-lightbox-data--opened",n="ps-lightbox-close--invert",u.prototype={init:function(){this.$container||(this.$container=o(e),this.$padding=this.$container.find(".ps-lightbox-padding"),this.$wrapper=this.$container.find(".ps-lightbox-wrapper"),this.$close=this.$container.find(".ps-lightbox-close"),this.$object=this.$container.find(".ps-lightbox-object"),this.$prev=this.$container.find(".ps-lightbox-arrow-prev"),this.$next=this.$container.find(".ps-lightbox-arrow-next"),this.$spinner=this.$container.find(".ps-lightbox-spinner"),this.$attachment=this.$container.find(".ps-lightbox-data"),this.$btnattachment=this.$container.find(".ps-lightbox-data-toggle"),this.$imagelink=this.$container.find(".ps-lightbox-imagelink"),this.attachevents(),this.$container.appendTo(document.body)),this.isMobile()&&(this.$viewport||(this.$viewport=o("meta[name=viewport]"),this.$viewport.length||(this.$viewport=o('<meta name="viewport" content="" />').appendTo("head"))),this.vpNoZoom="width=device-width, user-scalable=no",this.vpValue||(this.vpValue=this.$viewport.attr("content"),this.$viewport.attr("content",this.vpNoZoom))),this.options.simple?this.$container.addClass("ps-lightbox-simple"):this.$container.removeClass("ps-lightbox-simple"),this.$prev.hide(),this.$next.hide(),this.$container.show(),this.resetHeight(),this.options.simple&&this.setHeight();var t=o(window);t.off("resize.ps-lightbox"),this.options.simple&&t.on("resize.ps-lightbox",o.proxy(this.setHeight,this)),o(document.body).off("keyup.ps-lightbox").on("keyup.ps-lightbox",o.proxy(function(t){27===t.keyCode&&this.close()},this))},open:function(t,e){var i;this.data=t||[],this.options=e||{},this.index=e.index||0,this.init(),this.$container.removeClass("ps-lightbox--"+this.$container.attr("data-type")),this.$object.removeClass("ps-lightbox__object--"+this.$object.attr("data-type")),this.options.type?(this.$container.addClass("ps-lightbox--"+this.options.type),this.$object.addClass("ps-lightbox__object--"+this.options.type),this.$container.attr("data-type",this.options.type),this.$object.attr("data-type",this.options.type)):(this.$container.removeAttr("data-type"),this.$object.removeAttr("data-type")),this.options.simple||(i=o(`
					<div class="ps-lightbox__object-inner">
						<div class="ps-lightbox__object-container"></div>
					</div>
				`),_.each(this.data,function(t,e){i.children().append(`
					<div class="ps-lightbox__object-item ps-js-item" data-spinner="1">
						<div class="ps-lightbox__spinner ps-lightbox-spinner" style="display:block;"></div>
					</div>
				`)}),this.$object.empty(),this.$object.append(i),this.mySwipe=s(i[0],{draggable:!0,startSlide:this.index,callback:o.proxy(function(t,e){this.go(t)},this)})),this.togglenav(),this.go(this.index),this.options.showAttachment?(e=window.innerWidth||document.documentElement.clientWidth,delete this.options.showAttachment,e<=979?this.showAttachment():this.hideAttachment()):this.hideAttachment(),o("html, body").addClass("ps-lightbox--open")},close:function(t){this.$container&&(this.$container.hide(),this.$object.empty(),this.$attachment.empty(),this.isMobile()&&this.vpValue&&(this.$viewport.attr("content",this.vpValue),this.vpValue=!1),o(window).off("resize.ps-lightbox"),o(document.body).off("keyup.ps-lightbox"),o("html, body").removeClass("ps-lightbox--open"))},go:function(t){var e;if("function"==typeof this.options.beforechange&&this.options.beforechange(this),this.data[t])if(this.data[this.index]&&(e=this.$attachment.html().trim())&&(this.data[this.index].attachment=e),this.index=t,this.$attachment.html(this.data[this.index].attachment||""),this.options.simple)this.$object.html(this.data[this.index].content),(t=this.$object.find("img")).length&&(this.showLoading(),this.$close.hide(),t.on("load",o.proxy(function(){this.hideLoading(),this.$close.show(),this.resetHeight(),this.setHeight.apply(this)},this)),t=t.attr("src").replace("/thumbs/","/").replace(/_(l|m_s|s_s)\./,"."),this.$imagelink.find("a").attr("href",t)),this.options.nofulllink?this.$imagelink.hide():this.$imagelink.show(),this.$btnattachment.hide();else{var i=this.$object.find(".ps-js-item").eq(this.index);if((i=2===this.mySwipe.getNumSlides()?i.add(this.$object.find(".ps-js-item").eq(this.index+2)):i).data("spinner")){i.removeData("spinner"),i.removeAttr("data-spinner");let t=this.data[this.index].content,e=o("<div />").append(t).children("img");e.length?(0,l.default)(e[0],()=>{i.html(t)}):i.html(t)}this.$btnattachment.show()}"function"==typeof this.options.afterchange&&this.options.afterchange(this),o(document).trigger("ps_lightbox_navigate")},prev:function(){this.mySwipe.prev()},next:function(){this.mySwipe.next()},togglenav:function(){var t=this.$prev.add(this.$next);this.$container.off("click.ps-lightbox",".ps-lightbox-arrow-prev"),this.$container.off("click.ps-lightbox",".ps-lightbox-arrow-next"),o(window).off("keyup.ps-lightbox"),this.options.nonav||!this.data.length||this.data.length<=1?t.hide():(t.show(),this.$container.on("click.ps-lightbox",".ps-lightbox-arrow-prev",o.proxy(this.prev,this)),this.$container.on("click.ps-lightbox",".ps-lightbox-arrow-next",o.proxy(this.next,this)),o(window).on("keyup.ps-lightbox",o.proxy(function(t){t=t.keyCode;37===t?this.prev():39===t&&this.next()},this)))},isAttachmentOpened:function(){return this.$attachment.hasClass(i)},showAttachment:function(){this.$attachment.addClass(i),this.$close.addClass(n),this.toggleMobileView(),h.hooks.addAction("browser_resize","lightbox",()=>this.toggleMobileView())},hideAttachment:function(){this.$attachment.removeClass(i),this.$close.removeClass(n),h.hooks.removeAction("browser_resize","lightbox"),this.toggleMobileView()},showLoading:function(){this.$object.hide(),this.$spinner.show()},hideLoading:function(){this.$spinner.hide(),this.$object.show()},attachevents:function(){this.$container.on("click.ps-lightbox",".ps-lightbox-padding",o.proxy(function(t){t.target===t.currentTarget&&(t.stopPropagation(),this.close())},this)),this.$btnattachment.on("click",o.proxy(function(){this.isAttachmentOpened()?this.hideAttachment():this.showAttachment()},this)),this.$close.on("click",o.proxy(function(){this.isAttachmentOpened()?this.hideAttachment():this.close()},this)),this.$imagelink.on("click","a",o.proxy(function(){this.close()},this)),this.$attachment.on("keyup.ps-lightbox",function(t){t.stopPropagation()})},isMobile:function(){var t=/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(navigator.userAgent);return this.isMobile=t?function(){return!0}:function(){return!1},t},resetHeight:function(){this.$object.find("img").css("maxHeight","")},setHeight:_.debounce(function(){this.$object.find("img").css("maxHeight",this.$wrapper.height())},100),toggleMobileView:function(){var t="ps-lightbox--comments";(window.innerWidth||document.documentElement.clientWidth)<=979&&this.isAttachmentOpened()?this.$container.addClass(t):this.$container.removeClass(t)}},u),r=!!window.location.href.match(/#.*comment(\.\d+)+/),t(function(){setTimeout(function(){r=!1},6e3)}),peepso.lightbox=function(t,e){if("close"!==t){if("function"!=typeof t)return r&&((e=e||{}).showAttachment=!0,r=!1),void a.open(t,e||{});a.options=e||{},a.init(),a.showLoading(),t(function(t,e){r&&((e=e||{}).showAttachment=!0,r=!1),a.hideLoading(),a.open(t,e||{})})}else a.close()},peepso.simple_lightbox=function(t){peepso.lightbox([{content:'<div style="display:inline-block;"><img src="'+t+'" /></div>'}],{simple:!0})}}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{imagesloaded:39,swipejs:40}],18:[function(s,t,e){!function(o){!function(){"use strict";var t=i("undefined"!=typeof window?window.jQuery:void 0!==o?o.jQuery:null),e=i(s("./popover"));function i(t){return t&&t.__esModule?t:{default:t}}(0,t.default)(t=>{t(".ps-js-notifications").each(function(){new e.default(this)})})}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./popover":19}],19:[function(f,t,g){!function(c){!function(){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.default=void 0;var h=o("undefined"!=typeof window?window.jQuery:void 0!==c?c.jQuery:null),e=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};e=a(e);if(e&&e.has(t))return e.get(t);var i,o={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(i in t){var n;"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&((n=s?Object.getOwnPropertyDescriptor(t,i):null)&&(n.get||n.set)?Object.defineProperty(o,i,n):o[i]=t[i])}o.default=t,e&&e.set(t,o);return o}("undefined"!=typeof window?window.peepso:void 0!==c?c.peepso:null),t=o(f("./singleton")),i=o(f("../notification-popover"));function a(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,i=new WeakMap;return(a=function(t){return t?i:e})(t)}function o(t){return t&&t.__esModule?t:{default:t}}const s=peepsodata.mark_all_as_read_text,n=peepsodata.mark_all_as_read_confirm_text,r=peepsodata.show_unread_only_text,l=peepsodata.show_all_text,d=peepsodata.notification_header;let p=new t.default;class u extends i.default{constructor(t){super(t),this.loading=!1,this.loadEnd=!1,p.on("counter:updated",t=>{this.updateCounter(t)}),p.on("html:updated",t=>{this.updateHtml(t)}),p.on("unread_only:updated",t=>{this.updateButton(t)})}createHeader(){return d?(0,h.default)('<div class="ps-notif__box-header"></div>').html(d).on("click",t=>t.stopPropagation()):(0,h.default)()}createBody(){return super.createBody().on("mousedown",".ps-js-notification",t=>{this.onItemClick(t)}).on("click",".ps-js-mark-as-read",t=>{this.onMarkRead(t)}).on("click",".ps-js-notification a",t=>{t.stopPropagation()}).on("mousedown",".ps-js-mark-as-read",t=>{t.stopPropagation()})}createFooter(){this.$btnMarkAllRead=(0,h.default)('<a href="#">'+s+"</a>").on("click",t=>{this.onMarkAllRead(t)});var t=e.observer.applyFilters("notification_unread_only",0);return this.$btnToggleUnreadOnly=(0,h.default)('<a href="#">'+(t?l:r)+"</a>").on("click",t=>{this.onToggleUnreadOnly(t)}),(0,h.default)('<div class="ps-notif__box-footer"></div>').append(this.$btnMarkAllRead).append(this.$btnToggleUnreadOnly)}updateCounter(t){let e=this.$counter;0<t?e.text(t).show():e.hide()}updateHtml(t){this.html!==t&&(this.html=t,this.$popoverBody.html(t),(0,h.default)(document.body).hasClass("wp-admin")&&this.$popoverBody.find("a[href]").attr("target","_blank"))}updateButton(t){let e=this.$btnToggleUnreadOnly,i=t?l:r;this.loadEnd=!1,e.html(i)}toggle(t){super.toggle(t),this.html||(t=+this.$counter.text()||0,p.unreadCount=t,p.fetch(1))}loadNext(){let t,e;this.loading||this.loadEnd||(this.loading=!0,t=this.$popoverLoading,e=this.$popoverBody.append(t),e[0].scrollTop=e[0].scrollHeight,p.next().catch(()=>{this.loadEnd=!0}).then(()=>{this.loading=!1,t.detach(),this.loadEnd||this.tryLoadNext()}))}onItemClick(t){let e=(0,h.default)(t.currentTarget),i=e.data("id"),o=e.data("unread"),s="ps-notification--unread",n,a,r;t.stopPropagation(),3===t.which||t.ctrlKey||t.altKey||(n=e.find("a").eq(0),("_blank"===n.attr("target")||2===t.which||t.metaKey||t.shiftKey)&&(r=!0),o?(r||n.on("click",function(t){t.preventDefault(),t.stopPropagation()}),e.data("progress")||(e.data("progress",!0).css("opacity",.5),e.removeClass(s),a=e.find(".ps-js-mark-as-read").hide(),p.markRead(i).then(()=>{e.data("unread",!1),a.remove(),r||(n.off("click"),n[0].click(),this.openUrl(n.attr("href")))}).catch(()=>{e.addClass(s),a.show()}).then(()=>{e.data("progress",!1).css("opacity","")}))):r||this.openUrl(n.attr("href")))}onMarkRead(t){let e=(0,h.default)(t.currentTarget),i=e.closest(".ps-js-notification"),o=i.data("id"),s="ps-notification--unread";t.preventDefault(),t.stopPropagation(),i.data("progress")||(i.data("progress",!0).css("opacity",.5),i.removeClass(s),e.hide(),p.markRead(o).then(()=>{i.data("unread",!1),e.remove()}).catch(()=>{i.addClass(s),e.show()}).then(()=>{i.data("progress",!1).css("opacity","")}))}onMarkAllRead(t){let e=this.$btnMarkAllRead;t.preventDefault(),t.stopPropagation(),e.data("progress")||confirm(n)&&(e.data("progress",!0).css("opacity",.5),p.markRead().then(()=>{this.toggle()}).catch(h.default.noop).then(()=>{e.data("progress",!1).css("opacity","")}))}openUrl(t){let e=window.location.href,i=t,o=i.replace(/#.*$/,"")===e.replace(/#.*$/,"");setTimeout(function(){window.location=i,o&&window.location.reload()},1)}onToggleUnreadOnly(t){let e=this.$btnToggleUnreadOnly;t.preventDefault(),t.stopPropagation(),e.data("progress")||(this.$popoverBody.empty().append(this.$popoverLoading),e.data("progress",!0).css("opacity",.5),p.toggleUnreadOnly().catch(h.default.noop).then(()=>{e.data("progress",!1).css("opacity",""),this.tryLoadNext()}))}}g.default=u}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../notification-popover":21,"./singleton":20}],20:[function(t,e,s){!function(o){!function(){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var t,n=(t="undefined"!=typeof window?window.jQuery:void 0!==o?o.jQuery:null)&&t.__esModule?t:{default:t},a=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};e=r(e);if(e&&e.has(t))return e.get(t);var i,o={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(i in t){var n;"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&((n=s?Object.getOwnPropertyDescriptor(t,i):null)&&(n.get||n.set)?Object.defineProperty(o,i,n):o[i]=t[i])}o.default=t,e&&e.set(t,o);return o}("undefined"!=typeof window?window.peepso:void 0!==o?o.peepso:null);function r(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,i=new WeakMap;return(r=function(t){return t?i:e})(t)}let e;class i extends a.default.npm.EventEmitter{constructor(){if(!e){super(),(e=this).notifications=[""],this.unreadCount=null;let t=0;window.localStorage&&(t=+window.localStorage.getItem("peepso_notif_unread_only")),this.params={page:1,per_page:5,unread_only:t},a.observer.addFilter("notification_unread_only",()=>this.params.unread_only,10,1),this.fetchEnd=!1,a.observer.addAction("notification_update",t=>{this.doUpdate(t)},10,1)}return e}get html(){let t=_.flatten(this.notifications),e=t.join("");return e}doUpdate(t){t&&t.data&&(t=+(t.data["ps-js-notifications"]||{}).count,_.isNaN(t)||this.unreadCount===t||(this.unreadCount=t,this.emit("counter:updated",t),this.reset()))}reset(){return new a.Promise(t=>{this.notifications=[""],this.params.page=1,this.fetchEnd=!1,this.fetch().catch(n.default.noop).then(()=>{t()})})}fetch(t=null){let o=_.extend({},this.params,{page:t||this.params.page}),e,s;return e=new a.Promise((e,i)=>{this.fetchEnd?e([]):a.default.postJson("notificationsajax.get_latest",o,t=>{t.success?(s=t.data||{},e(s.notifications||[])):t.errors&&1===o.page?i(t.errors):e([])})}),e.then(t=>{_.isArray(t)&&t.length?this.notifications[o.page]=t:this.fetchEnd=!0}).catch(t=>{this.fetchEnd=!0,this.params.page=1,this.notifications=["",['<div class="ps-notification">','<a class="ps-notification__inside">','<div class="ps-notification__desc">',t.join("<br />"),"</div>","</a>","</div>"].join("")]}).then(()=>{this.emit("html:updated",this.html)}),e}next(){return new a.Promise((t,e)=>{let i=this.params.page+1;this.fetchEnd?e():this.fetch(i).then(()=>{this.params.page=i,t()})})}markRead(s=null){return new a.Promise((i,o)=>{a.default.postJson("notificationsajax.mark_as_read",s?{note_id:s}:null,t=>{var e;t.success?(t=(e=s?Math.max(this.unreadCount-1,0):0)-this.unreadCount,this.unreadCount=e,this.notifications=this.__markHtmlAsRead(this.notifications,s),this.emit("counter:updated",this.unreadCount),this.emit("html:updated",this.html),a.observer.doAction("notification_titlebar",t=(0<=t?"+":"")+t),i()):o()})})}toggleUnreadOnly(){return new a.Promise((t,e)=>{let i=this.params.unread_only;i=i?0:1,this.params.unread_only=i,this.reset().then(()=>{this.emit("unread_only:updated",i),window.localStorage&&window.localStorage.setItem("peepso_notif_unread_only",i),t()})})}__markHtmlAsRead(t,o=null){let s="ps-js-notification";return _.map(t,i=>{if(_.isArray(i))i=this.__markHtmlAsRead(i,o);else if(_.isString(i)&&i.length){let t=(0,n.default)("<div/>").html(i),e=t.find("."+s);o&&(e=e.filter("."+s+"--"+o)),e.removeClass("ps-notification--unread").removeAttr("data-unread"),e.find(".ps-js-mark-as-read").remove(),i=t.html()}return i},this)}}s.default=i}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],21:[function(t,e,s){!function(o){!function(){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var t,i=(t="undefined"!=typeof window?window.jQuery:void 0!==o?o.jQuery:null)&&t.__esModule?t:{default:t};const e=peepsodata.loading_gif;s.default=class{constructor(t){this.guid=_.uniqueId("psNotificationPopover_"),this.$elem=(0,i.default)(t),this.$counter=this.$elem.find(".ps-js-counter"),this.$popover=null,this.$popoverHeader=null,this.$popoverBody=null,this.$popoverFooter=null,this.$popoverLoading=null,this.$elem.on("click",t=>{this.toggle(t)}),this.render()}render(){this.$popover||(this.$popoverHeader=this.createHeader(),this.$popoverBody=this.createBody(),this.$popoverFooter=this.createFooter(),this.$popoverLoading=(0,i.default)('<div class="ps-loading ps-loading--notifs" />').append('<img src="'+e+'" />').appendTo(this.$popoverBody),this.$popover=(0,i.default)('<div class="ps-notif__box" />').append(this.$popoverHeader).append(this.$popoverBody).append(this.$popoverFooter).hide(),this.$elem.append(this.$popover))}createHeader(){return(0,i.default)()}createBody(){return(0,i.default)('<div class="ps-notifications ps-notifications--notifs" />').css({maxHeight:"40vh",overflow:"auto"}).on("wheel",t=>{this.disableParentScroll(t)}).on("scroll",t=>{this.handleScroll(t)})}createFooter(){return(0,i.default)()}toggle(t){let e="click."+this.guid;if(t&&t.preventDefault(),this.$popover||this.render(),this.$popover.is(":visible"))return(0,i.default)(document).off(e),void this.$popover.stop().slideUp("fast");_.defer(()=>{this.$popover.stop().slideDown({duration:"fast",done:()=>{(0,i.default)(document).one(e,t=>{this.$popover.hide()}),this.tryLoadNext()}})})}tryLoadNext(){var t=this.$popoverBody[0],e=t.scrollTop,t=t.scrollHeight-t.clientHeight;Math.abs(e-t)<=1&&this.loadNext()}loadNext(){}disableParentScroll(t){var e=t.currentTarget,i=e.scrollTop,o=t.originalEvent.deltaY;0===i&&o<0?(t.preventDefault(),t.stopPropagation()):(e=e.scrollHeight-e.clientHeight,Math.abs(i-e)<=1&&0<o&&(t.preventDefault(),t.stopPropagation()))}handleScroll(){this.tryLoadNext()}}}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],22:[function(t,e,i){"use strict";var o;function s(){this.can_submit=!1,this.$postbox=null,this.$url_preview_container=jQuery("<div class='ps-postbox__url-preview-wrapper url-preview-container'></div>"),this.embedData=null,this.embedExceptions=[]}(o=jQuery).fn.pspostbox=function(t){if(!(this.length<=0)){var i=this;return this.$textarea=null,this.$access=null,this.$charcount=null,this.$preview_button=null,this.$cancel_button=null,this.$save_button=null,this.$posttabs=null,this.$privacy_dropdown=null,this.can_submit=!1,this.init=function(t){var i=this,e={textarea:"textarea.ps-postbox-textarea",mirror:".ps-postbox-mirror",addons:".ps-postbox-addons",access:"#postbox_acc",save_url:"postbox.post",charcount:".ps-js-charcount",preview_button:".ps-js-btn-preview",cancel_button:".ps-button-cancel",save_button:".postbox-submit",send_button_text:void 0,text_length:peepsodata.postsize,autosize:!0};this.opts=e,o.extend(!0,this.opts,t),this.guid=_.uniqueId("postbox-"),this.$posttabs=o(this).find(".ps-postbox-tab-root").ps_posttabs({container:this}),this.$textarea=jQuery(this.opts.textarea,this),this.$mirror=jQuery(this.opts.mirror,this),this.$addons=jQuery(this.opts.addons,this),this.$access=o(this.opts.access,this),this._default_access=this.$access.val(),this.$charcount=o(this.opts.charcount,this),this.$preview_button=o(this.opts.preview_button,this),this.$cancel_button=o(this.opts.cancel_button,this),this.$save_button=o(this.opts.save_button,this),_.isUndefined(this.opts.send_button_text)||this.$save_button.html(this.opts.send_button_text),this.$preview_button.on("click",function(){window.postbox.check_url_preview("force")}),this.$privacy=o("#privacy-tab",this),this.orig_height=this.$textarea.height(),this.opts.autosize&&this.$textarea.autosize(),this.$textarea.attr("maxlength",this.opts.text_length).on("keydown",function(t){i.on_keydown(t)}).on("keypress",function(t){i.on_keypress(t)}).on("paste",function(t){i.on_paste(t)}).on("focus",function(t){i.on_focus()}).on("keyup",function(t){i.on_change()}).on("input",function(t){i.on_input()}),this.$charcount.html(this.opts.text_length+""),this.$privacy_dropdown=o(".ps-privacy-dropdown",this.$privacy),this.$privacy_dropdown.on("click a",jQuery.proxy(function(t){var e=jQuery(t.target).closest("a"),i=this.$privacy.find(".ps-js-interaction-wrapper .ps-js-interaction-toggle"),t=jQuery("#postbox_acc");i.find("i").attr("class",e.find("i").attr("class")),i.find("span").html(e.find("span").text()),t.val(e.attr("data-option-value"))},this)),this.$privacy.on("click",function(t){i.privacy(t)}),peepso.observer.addAction("postbox_group_set",function(t){t===i&&i.$privacy.hide()},10,1),peepso.observer.addAction("postbox_group_reset",function(t){t===i&&i.$privacy.show()},10,1),jQuery("nav.ps-postbox-tab ul li a").click(this.clear_tabs),jQuery("#status-post",i).addClass("active"),jQuery(this.$posttabs).on("peepso_posttabs_show-status",function(){jQuery("#status-post",i).addClass("active"),jQuery(".ps-postbox-status").show(),i.on_change()}),peepso.observer.addAction("postbox_type_set",function(t,e){t===i&&"status"===e&&jQuery("#status-post",i).trigger("click")},10,2),jQuery("#status-post",i).on("click",function(){jQuery(i.$posttabs).find("[data-tab='status']").trigger("click")}),this.$posttabs.on("peepso_posttabs_submit-status",function(){i.save_post()}),this.$posttabs.on("peepso_posttabs_cancel-status",function(){jQuery("#status-post",i).removeClass("active")}),this.$posttabs.on("peepso_posttabs_submit",function(){i.$textarea.attr("readonly","readonly"),i.find(".ps-postbox-status").css("opacity",.5)}),this.$posttabs.on("peepso_posttabs_cancel",function(){i.$textarea.val(""),i.cancel_post()}),this.find(".interactions > ul > li > .interaction-icon-wrapper a").on("click",function(t,e){e||i.find(".interactions > ul > li > .ps-js-interaction-wrapper a").not(this).trigger("peepso.interaction-hide",[!0])}),setTimeout(()=>{let e=()=>{let t=this.$textarea.val().trim(),e={hard:[],soft:[""!==t]},i=peepso.observer.applyFilters("peepso_postbox_can_submit",e,this),o=!0;return[...i.hard,...i.soft].forEach(t=>{t&&(o=!1)}),o},i=t=>{t?(this.addClass("ps-postbox--active"),this.find(".ps-js-postbox-footer").not(".ps-postbox-tab-root").show(),this.update_charcount()):(this.removeClass("ps-postbox--active"),this.find(".ps-js-postbox-footer").not(".ps-postbox-tab-root").hide(),this.$charcount.hide())};i(!e()),this.$textarea.on("focus",()=>this.click()),this.on("click",t=>{t.stopPropagation(),i(!0),o(document).off("click.postbox").one("click.postbox",()=>i(!e()))})},100),this._load_addons(),this.removeClass("ps-postbox--disabled")},this._load_addons=function(){var t=peepso.observer.applyFilters("peepso_postbox_addons",[]);o(t).each(function(t,e){e.set_postbox(i),e.init()})},this.clear_tabs=function(){peepso.observer.applyFilters("postbox_clear_tabs",null)},this.privacy=function(t){this.$privacy_dropdown.is(":visible")?(this.$privacy_dropdown.hide(),this.$privacy.removeClass("ps-postbox__menu-item--open"),jQuery(document).off("mouseup.ps-postbox-privacy")):(this.$privacy_dropdown.show(),this.$privacy.addClass("ps-postbox__menu-item--open"),setTimeout(function(){jQuery(document).off("mouseup.ps-postbox-privacy").on("mouseup.ps-postbox-privacy",function(t){0===this.$privacy.has(t.target).length&&(this.$privacy_dropdown.hide(),this.$privacy.removeClass("ps-postbox__menu-item--open"),o(document).off("mouseup.ps-postbox-privacy"))}.bind(this))}.bind(this),1))},this.save_post=function(){var t;peepso.observer.applyFilters("postbox_before_save",!0,this)&&(t={content:this.$textarea.val(),id:peepsodata.currentuserid,uid:peepsodata.userid,acc:this.$access.val(),type:"activity"},_.isUndefined(this.opts.postbox_req)||typeof Function!=typeof this.opts.postbox_req||(t=this.opts.postbox_req.apply(null,[t])),t=peepso.observer.applyFilters("postbox_req",t),t=peepso.observer.applyFilters("postbox_req_"+this.guid,t),this.save_post_queue||(this.save_post_queue=[]),this.save_post_queue.push(t),this.on_before_save(),this.save_post_progress||(this.save_post_progress=!0,this.save_post_execute()))},this.save_post_execute=function(){if(!this.save_post_queue.length)return peepso.observer.applyFilters("peepso_postbox_enter_to_send",!1)||(jQuery(".ps-postbox-loading",this).hide(),jQuery(".ps-postbox-action",this).css("display","flex"),this.$posttabs.on_cancel()),this.save_post_progress=!1,this.on_queue_clear(),void postbox.remove_broken_thumbnails();var e=this.save_post_queue.shift();peepso.observer.applyFilters("peepso_postbox_enter_to_send",!1)||(jQuery(".ps-postbox-action",this).css("display","none"),jQuery(".ps-postbox-loading",this).show()),peepso.disableAsync().postJson(this.opts.save_url,e,function(t){t.success?(i.on_save(t),jQuery(i).trigger("postbox.post_saved",[e,t])):i.on_error(t),i.save_post_execute()})},this.on_before_save=function(){typeof Function==typeof this.opts.on_before_save&&this.opts.on_before_save.apply(this)},this.on_save=function(t){var e=peepso.observer.applyFilters("peepso_postbox_onsave",!1,this);"function"==typeof e?e.apply(this,[t]):"function"==typeof this.opts.on_save&&(this.opts.on_save.apply(this,[t]),this.$textarea.css("height",this.orig_height),jQuery(this).trigger("postbox.post_saved",this))},this.on_queue_clear=function(){typeof Function==typeof this.opts.on_queue_clear&&this.opts.on_queue_clear.apply(this)},this.on_error=function(t){typeof Function==typeof this.opts.on_error?this.opts.on_error.apply(this,[t]):!1===_.isUndefined(t.errors[0])&&psmessage.show("Error",t.errors[0])},this.cancel_post=function(){this.$textarea.css("height",this.orig_height),this.$textarea.removeAttr("readonly"),this.find(".ps-postbox-status").css("opacity",""),this.on_change(),jQuery(this).trigger("postbox.post_cancel")},this.on_focus=function(){jQuery(".ps-postbox-tab-root",i).hide(),jQuery(".ps-postbox-tab.interactions",i).attr("data-tab-shown",this.$posttabs.current_tab().data("tab")),jQuery(".ps-postbox-tab.interactions",i).show()},this.on_keydown=function(t){if(this._go_submit=!1,13!==t.keyCode)return!0;var e=this.$textarea.val(),i=e.trim();return!t.shiftKey&&peepso.observer.applyFilters("peepso_postbox_enter_to_send",!1)&&(i.length||this.submitable(e))?(t.preventDefault(),this._go_submit=!0,this.$posttabs.on_submit(),!1):i.length?void 0:(t.preventDefault(),!1)},this.on_keypress=function(t){if(this.$textarea.val()>=this.opts.text_length)return!1},this.on_paste=function(t){var e=this;t.originalEvent.clipboardData.getData("text/plain").slice(0,this.text_length),setTimeout(function(){e.on_change()},100)},this.on_input=function(t){this._go_submit||(peepso.observer.applyFilters("peepso_postbox_input_changed",this.$textarea.val()),this.update_beautifier())},this.update_charcount=function(){var t=this.$textarea.val(),e=this.opts.text_length,i=Math.max(0,e-t.length);this.$charcount.html(i+""),i&&.5<i/e?this.$charcount.hide():(this.$charcount.show(),t="",0===i||i/e<.1?t="red":i/e<.25&&(t="orange"),this.$charcount.css({color:t}))},this.on_change=function(){this.update_charcount();var t=this.$textarea.val();this.submitable(t)&&!peepso.observer.applyFilters("peepso_postbox_enter_to_send",!1)?this.$save_button.show():this.$save_button.hide();t=t.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>");this.$mirror.html(t),this.addons_update()},this.submitable=function(t){var e=Math.max(0,this.opts.text_length-t.length),t=peepso.observer.applyFilters("peepso_postbox_can_submit",{hard:[],soft:[e<this.opts.text_length&&""!==t.trim()]},this);return(({hard:t,soft:e})=>{let i=!1;i=t.length?-1===t.indexOf(!1):-1!==e.indexOf(!0),i&&!this.beforeUnloadHandler?(this.beforeUnloadHandler=()=>!0,peepso.observer.addFilter("beforeunload",this.beforeUnloadHandler)):!i&&this.beforeUnloadHandler&&(peepso.observer.removeFilter("beforeunload",this.beforeUnloadHandler),this.beforeUnloadHandler=null),i?(this.$preview_button.show(),this.$cancel_button.show()):(this.$preview_button.hide(),this.$cancel_button.hide())})(t),t=t.hard.length?!(-1<t.hard.indexOf(!1)):-1<t.soft.indexOf(!0)},this.addons_update=jQuery.proxy(_.debounce(function(){var t,e=peepso.observer.applyFilters("peepso_postbox_addons_update",[]);e&&e.length?(t=this.$textarea.attr("placeholder"),this.$textarea.data("placeholder",t).removeAttr("placeholder"),this.$addons.html("&mdash; "+e.join(" and ")),this.$addons.show()):(t=this.$textarea.data("placeholder"),this.$textarea.attr("placeholder",t),this.$addons.hide().empty())},10),this),this.update_beautifier=_.throttle(function(){_.defer(_.bind(function(){var t;this.$beautifier||(this.$textarea.addClass("ps-tagging-textarea"),(t=this.$textarea.parent(".ps-postbox__input-tag")).length||(this.$textarea.wrap("<div class=ps-postbox__input-tag />"),t=this.$textarea.parent(".ps-postbox__input-tag")),this.$beautifier=t.children(".ps-postbox__input-beautifier"),this.$beautifier.length||(this.$beautifier=o("<div class=ps-postbox__input-beautifier />"),this.$beautifier.prependTo(t)),this.$textarea.focus()),(t=window._wpemojiSettings||{})&&t.supports&&(t.supports.everything=!0),t=this.$textarea.val()||"",t=(t=peepso.observer.applyFilters("peepso_postbox_beautifier",t,this.$textarea)).replace(/<(?!\/?ps_)/g,"&lt;").replace(/<(\/?)ps_/g,"<$1").replace(/\r?\n/g,"<br />"),this.$beautifier.html(t)},this))},100),this.init(t),this}},s.prototype.init=function(){var e=this;return peepso.observer.addFilter("peepso_postbox_can_submit",function(t){return t||e.can_submit},20,1),this.$activity_stream_recent=jQuery("#ps-activitystream-recent"),this.$activity_stream=jQuery("#ps-activitystream"),this.$postbox=jQuery("#postbox-main").pspostbox({postbox_req:function(t){return e.embedData&&(t.embed=e.embedData),t},on_save:function(t){return jQuery(this.$posttabs).find("[data-tab='status']").trigger("click"),e.append_to_stream(t)}}),void 0!==this.$postbox&&(this.$postbox.$textarea.on("blur",function(t){e.check_url_preview()}).on("keyup",function(t){32===t.keyCode&&e.check_url_preview()}),this.$postbox.on("postbox.post_saved postbox.post_cancel",()=>{e.can_submit=!1,e.$url_preview_container.empty().remove(),this.embedData=null,this.embedExceptions=[]})),this.$postbox},s.prototype.check_url_preview=function(t){if(!this.fetching&&"status"===this.$postbox.$posttabs.current_tab().data("tab")){var e=peepsodata.embed||{},i=+e.enable;if(i&&(t||!this.embedData)){let t=this.$postbox.$textarea.val(),o;if(o=t.match(/(^|\s)(https?:\/\/)?([a-z0-9-]+\.)+((com|net|org|int|edu|gov|mil|biz|info|mobi|co|io|me)(\.[a-z]{2})?)(?![a-z])(:\d+)?(\/[^*\s]*)?/gi)||t.match(/(^|\s)(https?:\/\/)([a-z0-9-]+\.)+([a-z]{2,24})(:\d+)?(\/[^*\s]*)?/gi),o=o&&o[0]&&o[0].trim(),o){o.match(/^https?:\/\//i)||(o=`https://${o}`);e=+e.enable_non_ssl;if((e||o.match(/^https:\/\//i))&&!(this.embedExceptions&&-1<this.embedExceptions.indexOf(o))){this.fetching=!0;let i=this.$postbox.$textarea.closest(".ps-postbox-input"),t=this.$postbox.find(".ps-postbox-loading").show(),e=this.$postbox.find(".ps-postbox-action").css("display","none");peepso.modules.url.getEmbed(o).then(t=>{this.embedData=o;let e=`<div class="ps-postbox__url-preview url-preview ps-stream-container-narrow">
				<div class="ps-postbox__url-close close">
					<a href="#" class="ps-js-remove"><i class="gcis gci-times"></i></a>
				</div>
				${t.html}
			</div>`;e=e.replace(/\/embed\/(#\?secret=[a-zA-Z0-9]+)?"/g,'/?embed=true$1"'),this.$url_preview_container.html(e).appendTo(i),this.$url_preview_container.on("click.ps-embed-remove",".ps-js-remove",()=>{this.$url_preview_container.off("click.ps-embed-remove"),this.$url_preview_container.empty().remove(),this.embedData=null,this.embedExceptions.push(o)}),e.match(/\sdata-instgrm-permalink/)&&setTimeout(function(){try{window.instgrm.Embeds.process()}catch(t){}},1e3)}).catch(()=>{}).then(()=>{this.fetching=!1,t.hide(),e.css("display","flex")})}}}}},s.prototype.append_to_stream=function(t){var e,i,o;t.data&&+t.data.post_id&&(0<jQuery("#ps-no-posts").length&&(jQuery(this.$activity_stream.css("display","block")),jQuery("#ps-no-posts").remove()),e=t.data.post_id,o=jQuery("<div />").append(t.data.html),o=peepso.observer.applyFilters("peepso_activity",o),i=(i=peepso.observer.applyFilters("peepso_activity_content",o.html())).replace(/\/embed\/(#\?secret=[a-zA-Z0-9]+)?"/g,'/?embed=true$1"'),t=jQuery(i).hide(),(o=(o=this.$activity_stream.children(".ps-js-activity-pinned")).filter(function(){var t=jQuery(this).prev(".ps-js-activity");return!t.length||t.hasClass("ps-js-activity-pinned")})).length&&!o.first().prev(".ps-js-activity").length?t.insertAfter(o.last()):t.prependTo(this.$activity_stream),t.each(function(){1===this.nodeType&&peepso.hooks.doAction("post_added",this)}),t.fadeIn("slow",function(){jQuery(this).find(".comment-container").hide(),jQuery(document).trigger("ps_activitystream_append",[jQuery("#peepso-wrap .ps-js-activity--"+e+" .ps-js-dropdown-toggle")]),peepso.util.scrollIntoViewIfNeeded(this,{position:"center"})}),peepso.observer.doAction("peepso_activity_actions",t.find("[data-type=stream-action]")),i.match(/\sdata-instgrm-permalink/)&&setTimeout(function(){try{window.instgrm.Embeds.process()}catch(t){}},1e3),peepso.observer.applyFilters("peepso_posttabs_cancel-status"))},s.prototype.remove_broken_thumbnails=function(){jQuery(".ps-media-thumbnail img").each(function(){var t=new Image,e=this;t.onerror=function(){jQuery(e).closest(".ps-media-thumbnail").remove()},t.src=e.src})},window.postbox=new s,jQuery(document).ready(function(){postbox.init()}),jQuery(function(){var t;jQuery.support.placeholder=!1,"placeholder"in document.createElement("input")&&(jQuery.support.placeholder=!0),jQuery.support.placeholder||(t=document.activeElement,jQuery("textarea").focus(function(){jQuery(this).attr("placeholder")&&0<jQuery(this).attr("placeholder").length&&""!==jQuery(this).attr("placeholder")&&jQuery(this).val()===jQuery(this).attr("placeholder")&&jQuery(this).val("").removeClass("hasPlaceholder")}).blur(function(){jQuery(this).attr("placeholder")&&0<jQuery(this).attr("placeholder").length&&""!==jQuery(this).attr("placeholder")&&(""===jQuery(this).val()||jQuery(this).val()===jQuery(this).attr("placeholder"))&&jQuery(this).val(jQuery(this).attr("placeholder")).addClass("hasPlaceholder")}),jQuery("textarea").blur(),jQuery(t).focus(),jQuery("form").submit(function(){jQuery(this).find(".hasPlaceholder").each(function(){jQuery(this).val("")})}))})},{}],23:[function(t,e,i){"use strict";t("./postbox"),t("./postbox-dropdown"),t("./postbox-type"),t("./postbox-schedule")},{"./postbox":27,"./postbox-dropdown":24,"./postbox-schedule":25,"./postbox-type":26}],24:[function(t,e,a){!function(n){!function(){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var t,i=(t="undefined"!=typeof window?window.jQuery:void 0!==n?n.jQuery:null)&&t.__esModule?t:{default:t},e="undefined"!=typeof window?window.peepso:void 0!==n?n.peepso:null;let o=0;e.observer.addFilter("class_postbox_dropdown",()=>s);class s{constructor(t,e={}){this.id=`ps-postbox-dropdown--${++o}`,this.opts=e,this.$postbox=(0,i.default)(t).closest(".ps-js-postbox"),this.$container=(0,i.default)(t),this.$toggle=this.$container.find(".ps-js-postbox-toggle").first(),this.$dropdown=this.$container.find(".ps-js-postbox-dropdown").first(),this.$toggle.on("click",()=>this.toggle())}toggle(){this.$dropdown.is(":visible")?this.hide():this.show()}show(){this.$dropdown.show(),this.$container.addClass("ps-postbox__menu-item--open"),setTimeout(()=>{(0,i.default)(document).off(`mouseup.${this.id}`).on(`mouseup.${this.id}`,t=>{0===this.$container.has(t.target).length&&this.hide()})},1)}hide(){this.$dropdown.hide(),this.$container.removeClass("ps-postbox__menu-item--open"),(0,i.default)(document).off(`mouseup.${this.id}`)}}e=s;a.default=e}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],25:[function(d,t,e){!function(n){!function(){"use strict";var t,i=(t="undefined"!=typeof window?window.jQuery:void 0!==n?n.jQuery:null)&&t.__esModule?t:{default:t},o="undefined"!=typeof window?window.peepso:void 0!==n?n.peepso:null,e="undefined"!=typeof window?window.peepsodata:void 0!==n?n.peepsodata:null,a=d("../datetime");const r=e.datetime&&e.datetime.text.monthNames,h=e.datetime&&e.datetime.text.am,l=e.datetime&&e.datetime.text.pm;class s extends o.observer.applyFilters("class_postbox_dropdown",10,1){constructor(t){super(t.find("#schedule-tab")[0]),this.$postbox=t,this.$radio=this.$container.find("[type=radio]"),this.$datetime=this.$container.find(".ps-js-datetime"),this.$date=this.$container.find(".ps-js-date-dd"),this.$month=this.$container.find(".ps-js-date-mm"),this.$year=this.$container.find(".ps-js-date-yy"),this.$hour=this.$container.find(".ps-js-time-hh"),this.$minute=this.$container.find(".ps-js-time-mm"),this.$ampm=this.$container.find(".ps-js-time-ampm"),this.$done=this.$container.find(".ps-js-done"),this.minuteInterval=+this.$minute.data("interval")||15,this.dateSelector=null,this.timeSelector=null,this.$done.on("click",()=>this.hide()),this.$dropdown.on("click","[data-option-value]",t=>{var e=(0,i.default)(t.currentTarget).data("optionValue");t.stopPropagation(),this.select(e),"now"===e&&this.hide()}),this.$postbox.on("postbox.post_cancel postbox.post_saved",()=>{this.resetDateTime(),this.select("now")}),o.observer.addFilter("postbox_req",i.default.proxy(this.filterPostboxReq,this),10,1),o.observer.addFilter("postbox_data",i.default.proxy(this.filterPostboxData,this),10,2),o.observer.addAction("postbox_update",i.default.proxy(this.actionPostboxUpdate,this),10,2),o.observer.addAction("postbox_group_set",i.default.proxy(this.actionPostboxGroupSet,this),10,1),o.observer.addAction("postbox_group_reset",i.default.proxy(this.actionPostboxGroupReset,this),10,1)}value(){let t;return this.$radio.get(1).checked&&this.dateSelector&&this.timeSelector&&(t=`${this.dateSelector.getDate()} ${this.timeSelector.getTime()}`),t}select(t){if("now"===t){this.$radio.get(0).checked=!0,this.$datetime.hide(),this.$container.removeClass("active");let t=this.$container.find(".ps-js-interaction-toggle");t.attr("data-tooltip-original")&&(t.attr("data-tooltip",t.attr("data-tooltip-original")),t.removeAttr("data-tooltip-original")),o.observer.doAction("postbox_schedule_reset",this.$postbox)}else{var e;"future"===t&&(this.$radio.get(1).checked=!0,this.$datetime.show(),this.$container.addClass("active"),this.initDateTime(),e=this.$container.find(".ps-js-interaction-toggle"),t=`${this.timeSelector.getTime(!0)}, ${this.dateSelector.getDate(!0)}`,e.attr("data-tooltip-original")||e.attr("data-tooltip-original",e.attr("data-tooltip")),e.attr("data-tooltip",t),o.observer.doAction("postbox_schedule_set",this.$postbox,this.value()))}}initDateTime(){if(!this.dateSelector&&!this.timeSelector){var n=()=>{let t=new Date,e,i,o;e=this.dateSelector.getDate().split("-"),i=this.timeSelector.getTime().split(":"),o=new Date(+e[0],+e[1]-1,+e[2],+i[0],+i[1]),t.setHours(t.getHours()+1,t.getMinutes()+(this.minuteInterval-t.getMinutes()%this.minuteInterval),0),o<t&&this.timeSelector.setTime(`${t.getHours()}:${t.getMinutes()}`)};let t=r,e=new Date,i=new Date,o={monthNames:t,minDate:e,maxDate:i,onSelect:n},s={step:this.minuteInterval,am:h,pm:l,onSelect:n};i.setFullYear(Math.max(2035,i.getFullYear()+1)),this.dateSelector=new a.DateSelector(this.$year[0],this.$month[0],this.$date[0],o),this.timeSelector=new a.TimeSelector(this.$hour[0],this.$minute[0],this.$ampm.length?this.$ampm[0]:s,this.$ampm.length?s:void 0),this.resetDateTime()}}resetDateTime(){let t=new Date;t.setDate(t.getDate()+1),this.setDateTime(t)}setDateTime(t){this.initDateTime();var e=`${t.getFullYear()}-${t.getMonth()+1}-${t.getDate()}`,t=`${t.getHours()}:${t.getMinutes()}`;this.dateSelector.setDate(e),this.timeSelector.setTime(t)}filterPostboxReq(t){var e=this.value();return e&&(t.future=e),t}filterPostboxData(t,e){return e.$el!==this.$postbox||(e=this.value())&&(t.future=e),t}actionPostboxUpdate(t,o){if(t.$el===this.$postbox)if(o.future){let[t,e]=o.future.split(" "),i;t=t.split("-"),e=e.split(":"),i=new Date(+t[0],+t[1]-1,+t[2],+e[0],+e[1]),this.select("future"),this.setDateTime(i)}else this.select("now"),this.resetDateTime(),this.$container.hide()}actionPostboxGroupSet(t){t===this.$postbox&&(this.select("now"),this.$container.hide())}actionPostboxGroupReset(t){t===this.$postbox&&this.$container.show()}}o.observer.addAction("peepso_postbox_addons",t=>{return t.push({init(){},set_postbox(t){t.find("#schedule-tab").length&&new s(t)}}),t},10,1),o.observer.addAction("postbox_init",t=>{let e=t.$el;e.find("#schedule-tab").length&&new s(e)},10,1)}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../datetime":9}],26:[function(t,e,i){!function(o){!function(){"use strict";var t,i=(t="undefined"!=typeof window?window.jQuery:void 0!==o?o.jQuery:null)&&t.__esModule?t:{default:t},a="undefined"!=typeof window?window.peepso:void 0!==o?o.peepso:null;class e extends a.observer.applyFilters("class_postbox_dropdown",10,1){constructor(t){super(t.find("#type-tab")[0]),this.$postbox=t,this.defaultIcon=this.$toggle.children("a").find("i").attr("class"),this.defaultText=this.$toggle.children("a").find("span").html(),this.$dropdown.on("click","[data-option-value]",t=>{var e=(0,i.default)(t.currentTarget).data("optionValue");t.stopPropagation(),this.select(e),this.hide()}),this.$postbox.on("postbox.post_saved",()=>{"function"!=typeof a.observer.applyFilters("peepso_postbox_onsave",!1,this.$postbox)&&this.select("status")}),this.select("status")}show(){this.$dropdown.show(),setTimeout(()=>{(0,i.default)(document).off(`mouseup.${this.id}`).on(`mouseup.${this.id}`,t=>{0===this.$container.has(t.target).length&&this.hide()})},1)}hide(){this.$dropdown.hide(),(0,i.default)(document).off(`mouseup.${this.id}`)}select(t){let e=this.$dropdown.find(`[data-option-value="${t}"]`),i=this.$toggle.children("a"),o=e.find("i"),s=o.attr("class").replace(/^.*(gci-[^\s]+).*$/,"$1"),n=i.find("i").filter(`.${s}`);e.length&&(e.addClass("active"),e.siblings(".active").removeClass("active"),n.addClass("active"),n.siblings(".active").removeClass("active").css("color",""),a.observer.doAction("postbox_type_set",this.$postbox,t))}}a.observer.addAction("peepso_postbox_addons",t=>{return t.push({init(){},set_postbox(t){t.find("#type-tab").length&&new e(t)}}),t},10,1),a.observer.addAction("postbox_init",t=>{let e=t.$el;e.find("#type-tab").remove()},10,1)}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],27:[function(t,e,i){"use strict";function o(){this.__constructor.apply(this,arguments)}var s,n,a;s=jQuery,n=s,peepso.npm.objectAssign(o.prototype,PsObserver.prototype,{__constructor:function(t,e){var i=peepso.template(psdata_postbox.template);this.$el=n(t).html(i),this.$text=this.$el.find("textarea").ps_autosize(),this.$mirror=this.$el.find(".ps-js-mirror"),this.$loading=this.$el.find(".ps-postbox-loading"),this.$btns=this.$el.find(".ps-postbox-action"),this.$btnCancel=this.$btns.find(".ps-button-cancel"),this.$btnSubmit=this.$btns.find(".ps-button-action"),this.$charCounter=this.$el.find(".ps-js-charcount"),this.$tabRoot=this.$el.find("div.ps-postbox-tab-root"),this.$tabContext=this.$el.find("nav.ps-postbox-tab"),this.$addons=this.$el.find(".ps-js-addons"),this.opts=n.extend({maxChars:+psdata_postbox.max_chars||4e3,fetch:!1,cancel:!1,submit:!1},e||{}),this.init()},init:function(){this.$text.val(""),this.updateButtonVisibility(),this.updateCharCounter(),this.updateMirrorText(),this.addAction("refresh",this.refresh,10,1,this),this.$el.find("#privacy-tab").remove(),this.$el.find("#status-post").remove(),peepso.observer.doAction("postbox_init",this),this.fetch().done(function(){this.$text.on("focus.ps-postbox",n.proxy(this.onFocus,this)),this.$text.on("input.ps-postbox",n.proxy(this.onInput,this)),this.$btnSubmit.on("click.ps-postbox",n.proxy(this.onSubmit,this)),this.$btnCancel.on("click.ps-postbox",n.proxy(this.onCancel,this)),this.$tabRoot.on("click.ps-postbox","li[data-tab]",n.proxy(this.onTabChange,this))})},fetch:function(){return n.Deferred(n.proxy(function(t){"function"==typeof this.opts.fetch?(this.$btns.hide(),this.$loading.show(),this.opts.fetch(this,n.proxy(function(){this.$loading.hide(),this.$btns.css("display","flex"),t.resolveWith(this)},this))):t.resolveWith(this)},this))},update:function(t){this.$text.val(t.content||"").trigger("input"),this.updateButtonVisibility(),this.updateCharCounter(),this.updateMirrorText(),this.doAction("update",t),peepso.observer.doAction("postbox_update",this,t)},reset:function(){this.$text.val(""),this.updateButtonVisibility(),this.updateCharCounter(),this.updateMirrorText(),this.doAction("reset"),peepso.observer.doAction("postbox_reset",this)},refresh:function(){this.renderAddons(),this.updateButtonVisibility(),this.updateCharCounter(),this.updateMirrorText()},_getData:function(){return{content:this.$text.val()}},getData:function(){var t=this._getData(),t=this.applyFilters("data",t);return peepso.observer.applyFilters("postbox_data",t,this)},tabChange:function(t){var e=this.$tabRoot.find("li[data-tab]"),i=e.filter('[data-tab="'+t+'"]');i.length&&(e.not(i).removeClass("active"),i.addClass("active"),this.currentTab=t)},getActiveTab:function(){return this.currentTab||(this.currentTab=this.$tabRoot.find("li.active").data("tab")),this.currentTab},validate:function(){var t=this._getData(),e=t.content.trim();return this.applyFilters("data_validate",!!e,t)},submit:function(){"function"==typeof this.opts.submit&&this.validate()&&(this.$btns.hide(),this.$loading.show(),this.opts.submit(this,this.getData(),n.proxy(function(){this.$loading.hide(),this.$btns.css("display","flex")},this)))},cancel:function(){this.reset(),this.$tabContext.hide(),this.$tabRoot.show(),"function"==typeof this.opts.cancel&&this.opts.cancel(this)},updateCharCounter:_.throttle(function(){var t=this.$text.val().length,e=this.opts.maxChars,i=Math.max(0,e-t),o="";this.$charCounter.html(i),t<.5*e?this.$charCounter.hide():(this.$charCounter.show(),.9*e<t?o="red":e<t<.75&&(o="orange"),this.$charCounter.css({color:o}))},250),updateButtonVisibility:_.throttle(function(){this.validate()?this.$btnSubmit.show():this.$btnSubmit.hide()},250),updateMirrorText(){requestAnimationFrame(()=>{var t=this.$text.val().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>");this.$mirror.html(t)})},renderAddons(){requestAnimationFrame(()=>{var t=(t=this.applyFilters("render_addons",[]).join(" and "))&&"&mdash; "+t;this.$addons.html(t)})},destroy:function(){this.$el.empty()},onFocus:function(){this.$tabRoot.hide(),this.$tabContext.show()},onInput:function(){this.updateButtonVisibility(),this.updateCharCounter(),this.updateMirrorText()},onCancel:function(){this.cancel()},onSubmit:function(){this.submit()},onTabChange:function(t){t=n(t.currentTarget).data("tab");this.tabChange(t)}}),a=o,s.fn.ps_postbox=function(i,o){return this.each(function(){var t=s(this),e=t.data("ps-postbox");e&&"string"==typeof i?(e[i].call(e,o),"destroy"===i&&t.removeData("ps-postbox")):e||(e=new a(t,i||{}),t.data("ps-postbox",e))})}},{}],28:[function(t,e,i){"use strict";var o;(o=jQuery).fn.ps_posttabs=function(t){return this._tabs=null,this._tabs_div={},this.tab_objects={},this.orig_html={},this.options={container:this},this.init=function(t){var i=this;o.extend(!0,this.options,t),o("[data-tab-id]",this.options.container).each(function(t,e){i._tabs_div[o(e).data("tab-id")]=o(e)}),this._tabs=this.find("[data-tab]"),this._tabs.on("click",function(t){t=o(t.currentTarget);i.current_tab_id=t.data("tab"),i.show_tab(t)}).first().trigger("click"),jQuery(this.options.container).on("click",".ps-postbox-tab.interactions .ps-button-cancel",function(){i.on_cancel()}),jQuery(this.options.container).on("click",".ps-postbox-tab.interactions .postbox-submit",function(){i.on_submit()})},this.show_tab=function(t){var e=this.current_tab();e.removeClass("active");var i=this.get_tab(e.data("tab"));i.hide(),o(this).trigger("peepso_posttabs_cancel-"+e.data("tab"),[i,this]),o(t).addClass("active");i=this.get_tab(o(t).data("tab"));o(this).trigger("peepso_posttabs_show-"+o(t).data("tab"),[i,this])},this.current_tab=function(){return o("[data-tab]",this.options.container).filter(".active")},this.get_tab=function(t){return _.isUndefined(this._tabs_div[t])?o(""):this._tabs_div[t]},this.on_submit=function(){var t=this.options.container;peepso.hooks.applyFilters("postbox_can_submit",!0,t)&&(t=this.current_tab(),peepso.observer.applyFilters("peepso_posttabs_submit-"+t.data("tab")),o(this).trigger("peepso_posttabs_submit-"+t.data("tab")),o(this).trigger("peepso_posttabs_submit",[t,this]))},this.on_cancel=function(){var t=this.current_tab();o(this).trigger("peepso_posttabs_cancel-"+t.data("tab"),[t,this]),o(this).trigger("peepso_posttabs_cancel",[t,this]),t.trigger("click")},this.init(t),this}},{}],29:[function(t,e,i){!function(e){!function(){"use strict";var t,i=(t="undefined"!=typeof window?window.jQuery:void 0!==e?e.jQuery:null)&&t.__esModule?t:{default:t};i.default.fn.psSafetyWarning=function(){return this.each((t,e)=>{(0,i.default)(e).find(".ps-js-close").on("click",t=>{(0,i.default)(t.target).closest(".ps-js-safety-warning").remove()})})},(0,i.default)(()=>{(0,i.default)(".ps-js-safety-warning").psSafetyWarning()})}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],30:[function(t,e,i){"use strict";function o(){}window.share=new o,o.prototype.share_url=function(t){let e,i;var o;return t=encodeURIComponent(t),e=jQuery("#share-dialog-title").html(),i=jQuery("#share-dialog-content").html(),i=(o="--peepso-url--",t=t,i.replace(new RegExp(o,"g"),t)),i=jQuery(i),i.filter(".ps-sharebox").find("a.ps-sharebox__item").on("click",function(t){t.preventDefault(),t.stopPropagation();t=["toolbar=no","location=no","status=no","menubar=no","scrollbars=yes","resizable=yes","width=550","height=400",`left=${Math.max(0,(window.innerWidth-550)/2||0)}`,`top=${Math.max(0,(window.innerHeight-400)/2||0)}`].join(",");window.open(this.href,"targetWindow",t),pswindow.hide()}),pswindow.show(e,i),!1}},{}],31:[function(t,e,i){"use strict";jQuery(t=>{let e=t("#peepso-wrap");if(e.length){let t=e.closest(".et_pb_row");t.length&&t.find(".et_pb_column").css({zIndex:"auto"})}})},{}],32:[function(t,e,i){"use strict";function d(){return Math.floor((new Date).getTime()/1e3)}function o(){this.ts=d(),this.diff=p.peepsotimedata.ts-this.ts}var s,n,p,a;s=window,n=jQuery,p=s,a=n,o.prototype.human_time_diff=function(t,e){var i,o,s,n,a=86400,r=7*a,h=365*a,l=p.peepsotimedata||{};return t=+t,e=e||d(),e+=this.diff,(i=Math.abs(e-t))<60?n=l.now:i<3600?n=(1<(o=(o=Math.round(i/60))<=1?1:o)?l.mins:l.min).replace("%s",o):i<a&&3600<=i?n=(1<(s=(s=Math.round(i/3600))<=1?1:s)?l.hours:l.hour).replace("%s",s):i<r&&a<=i?n=(1<(s=(s=Math.round(i/a))<=1?1:s)?l.days:l.day).replace("%s",s):i<30*a&&r<=i?n=(1<(r=(r=Math.round(i/r))<=1?1:r)?l.weeks:l.week).replace("%s",r):i<h&&30*a<=i?n=(1<(a=(a=Math.round(i/(30*a)))<=1?1:a)?l.months:l.month).replace("%s",a):h<=i&&(n=(1<(h=(h=Math.round(i/h))<=1?1:h)?l.years:l.year).replace("%s",h)),peepso.observer.applyFilters("human_time_diff",n,i,t,e)},a(function(){setInterval(function(){var i=d();a(".ps-js-autotime").each(function(){var t=a(this),e=t.data("timestamp");e&&t.html(ps_time.human_time_diff(e,i))})},4e4)}),n=o,s.ps_time=new n},{}],33:[function(t,e,i){"use strict";t("./widget-profile"),t("./widget-latest-members"),t("./widget-online-members"),t("./widget-userbar")},{"./widget-latest-members":34,"./widget-online-members":35,"./widget-profile":36,"./widget-userbar":37}],34:[function(t,e,i){!function(e){!function(){"use strict";var t,r=(t="undefined"!=typeof window?window.jQuery:void 0!==e?e.jQuery:null)&&t.__esModule?t:{default:t},h="undefined"!=typeof window?window.peepso:void 0!==e?e.peepso:null;(0,r.default)(function(){let t=(0,r.default)(".ps-js-widget-latest-members");t.length&&t.each((t,e)=>function(t){let e=(0,r.default)(t),i=e.find(".ps-js-widget-content"),o=+e.data("hideempty"),s=+e.data("limit"),n=+e.data("totalmember")?1:0,a={limit:s,totalmember:n};h.ajax.get("widgetajax.latest_members",a).done(t=>{t.success&&(o&&+t.data.empty?(i.empty(),e.parent('[class*="widget_"]').hide()):(i.html(t.data.html),e.parent('[class*="widget_"]').show()))})}(e))})}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],35:[function(t,e,i){!function(e){!function(){"use strict";var t,h=(t="undefined"!=typeof window?window.jQuery:void 0!==e?e.jQuery:null)&&t.__esModule?t:{default:t},l="undefined"!=typeof window?window.peepso:void 0!==e?e.peepso:null;(0,h.default)(function(){let t=(0,h.default)(".ps-js-widget-online-members");t.length&&t.each((t,e)=>function(t){let e=(0,h.default)(t),i=e.find(".ps-js-widget-content"),o=+e.data("hideempty"),s=+e.data("limit"),n=+e.data("totalmember")?1:0,a=+e.data("totalonline")?1:0,r={limit:s,totalmember:n,totalonline:a};l.ajax.get("widgetajax.online_members",r).done(t=>{t.success&&(o&&+t.data.empty?(i.empty(),e.parent('[class*="widget_"]').hide()):(i.html(t.data.html),e.parent('[class*="widget_"]').show()))})}(e))})}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],36:[function(t,e,i){!function(e){!function(){"use strict";var t,a=(t="undefined"!=typeof window?window.jQuery:void 0!==e?e.jQuery:null)&&t.__esModule?t:{default:t},r="undefined"!=typeof window?window.peepso:void 0!==e?e.peepso:null,h="undefined"!=typeof window?window.peepsodata:void 0!==e?e.peepsodata:null;(0,a.default)(function(){let t=(0,a.default)(".ps-js-widget-me");t.length&&t.each((t,e)=>function(t){let e=(0,a.default)(t);e.find(".ps-js-widget-me-notifications").length&&r.observer.doAction("notification_start");let i=e.find(".ps-js-widget-me-cover");i.length&&r.hooks.addAction("profile_cover_updated","widget_me",function(t,e){+t==+h.currentuserid&&i.css("background-image","url("+e+")")});let o=e.find(".ps-js-widget-me-avatar");o.length&&r.hooks.addAction("profile_avatar_updated","widget_me",function(t,e){+t==+h.currentuserid&&o.attr("src",e)});let s=e.find(".ps-js-widget-me-completeness");if(s.length){let i=s.find(".ps-js-status"),o=s.find(".ps-js-progressbar");r.hooks.addAction("profile_completeness_updated","widget_me",function(t,e={}){+t==+h.currentuserid&&void 0!==e.profile_completeness&&(100<=+e.profile_completeness?s.hide():(s.show(),i.html(e.profile_completeness_message),o.children("span").css({width:`${+e.profile_completeness}%`})))})}let n=e.find(".ps-js-widget-community-link").filter((t,e)=>e.href.match(/#(following|saved)/));n.on("click",function(){window.location.href.replace(/#.*$/,"")===this.href.replace(/#.*$/,"")&&setTimeout(function(){window.location.reload()},1)}),setTimeout(function(){var t=window.innerWidth/2;e.width()<t&&e.offset().left>t&&e.find(".ps-notif__box").css({left:"unset",right:1})},1)}(e))})}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(t,e,i){!function(e){!function(){"use strict";var t,h=(t="undefined"!=typeof window?window.jQuery:void 0!==e?e.jQuery:null)&&t.__esModule?t:{default:t},l="undefined"!=typeof window?window.peepso:void 0!==e?e.peepso:null;(0,h.default)(function(){let t=(0,h.default)(".ps-js-widget-userbar");t.length&&t.each((t,e)=>function(t){let e=(0,h.default)(t),i=e.find(".ps-js-widget-userbar-notifications");i.length&&i.html().trim()&&l.observer.doAction("notification_start");let o=e.find(".ps-js-widget-userbar-toggle");var s,n,a,r;o.on("click",function(t){t.preventDefault(),t.stopPropagation();let e=(0,h.default)(this),i=e.closest(".ps-js-widget-userbar");i.toggleClass("psw-userbar--open")}),"function"==typeof MutationObserver&&(t=e.find(".ps-js-widget-userbar-notifications"),s=t.find(".ps-js-counter"),n=e.find(".ps-js-notif-counter"),s.length&&((r=function(){clearTimeout(a),a=setTimeout(function(){var t=0;s.each(function(){t+=+this.innerText||0}),n.html(t||"")},1e3)})(),new MutationObserver(function(t){for(var e of t)"childList"===e.type&&e.target.className.match(/ps-js-counter/)&&r()}).observe(t[0],{childList:!0,subtree:!0,attributes:!1,characterData:!0})))}(e))})}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],38:[function(t,e,i){var o,s;o="undefined"!=typeof window?window:this,s=function(){"use strict";function t(){}var e=t.prototype;return e.on=function(t,e){if(t&&e){var i=this._events=this._events||{},t=i[t]=i[t]||[];return-1==t.indexOf(e)&&t.push(e),this}},e.once=function(t,e){if(t&&e){this.on(t,e);var i=this._onceEvents=this._onceEvents||{};return(i[t]=i[t]||{})[e]=!0,this}},e.off=function(t,e){t=this._events&&this._events[t];if(t&&t.length){e=t.indexOf(e);return-1!=e&&t.splice(e,1),this}},e.emitEvent=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){i=i.slice(0),e=e||[];for(var o=this._onceEvents&&this._onceEvents[t],s=0;s<i.length;s++){var n=i[s];o&&o[n]&&(this.off(t,n),delete o[n]),n.apply(this,e)}return this}},e.allOff=function(){delete this._events,delete this._onceEvents},t},"function"==typeof define&&define.amd?define(s):"object"==typeof e&&e.exports?e.exports=s():o.EvEmitter=s()},{}],39:[function(t,o,e){!function(e,i){"use strict";"function"==typeof define&&define.amd?define(["ev-emitter/ev-emitter"],function(t){return i(e,t)}):"object"==typeof o&&o.exports?o.exports=i(e,t("ev-emitter")):e.imagesLoaded=i(e,e.EvEmitter)}("undefined"!=typeof window?window:this,function(e,t){"use strict";var n=e.jQuery,a=e.console;function r(t,e){for(var i in e)t[i]=e[i];return t}var h=Array.prototype.slice;function l(t,e,i){if(!(this instanceof l))return new l(t,e,i);var o,s=t;(s="string"==typeof t?document.querySelectorAll(t):s)?(this.elements=(o=s,Array.isArray(o)?o:"object"==typeof o&&"number"==typeof o.length?h.call(o):[o]),this.options=r({},this.options),"function"==typeof e?i=e:r(this.options,e),i&&this.on("always",i),this.getImages(),n&&(this.jqDeferred=new n.Deferred),setTimeout(this.check.bind(this))):a.error("Bad element for imagesLoaded "+(s||t))}(l.prototype=Object.create(t.prototype)).options={},l.prototype.getImages=function(){this.images=[],this.elements.forEach(this.addElementImages,this)},l.prototype.addElementImages=function(t){"IMG"==t.nodeName&&this.addImage(t),!0===this.options.background&&this.addElementBackgroundImages(t);var e=t.nodeType;if(e&&d[e]){for(var i=t.querySelectorAll("img"),o=0;o<i.length;o++){var s=i[o];this.addImage(s)}if("string"==typeof this.options.background)for(var n=t.querySelectorAll(this.options.background),o=0;o<n.length;o++){var a=n[o];this.addElementBackgroundImages(a)}}};var d={1:!0,9:!0,11:!0};function i(t){this.img=t}function o(t,e){this.url=t,this.element=e,this.img=new Image}return l.prototype.addElementBackgroundImages=function(t){var e=getComputedStyle(t);if(e)for(var i=/url\((['"])?(.*?)\1\)/gi,o=i.exec(e.backgroundImage);null!==o;){var s=o&&o[2];s&&this.addBackground(s,t),o=i.exec(e.backgroundImage)}},l.prototype.addImage=function(t){t=new i(t);this.images.push(t)},l.prototype.addBackground=function(t,e){e=new o(t,e);this.images.push(e)},l.prototype.check=function(){var o=this;function e(t,e,i){setTimeout(function(){o.progress(t,e,i)})}this.progressedCount=0,this.hasAnyBroken=!1,this.images.length?this.images.forEach(function(t){t.once("progress",e),t.check()}):this.complete()},l.prototype.progress=function(t,e,i){this.progressedCount++,this.hasAnyBroken=this.hasAnyBroken||!t.isLoaded,this.emitEvent("progress",[this,t,e]),this.jqDeferred&&this.jqDeferred.notify&&this.jqDeferred.notify(this,t),this.progressedCount==this.images.length&&this.complete(),this.options.debug&&a&&a.log("progress: "+i,t,e)},l.prototype.complete=function(){var t=this.hasAnyBroken?"fail":"done";this.isComplete=!0,this.emitEvent(t,[this]),this.emitEvent("always",[this]),this.jqDeferred&&(t=this.hasAnyBroken?"reject":"resolve",this.jqDeferred[t](this))},(i.prototype=Object.create(t.prototype)).check=function(){this.getIsImageComplete()?this.confirm(0!==this.img.naturalWidth,"naturalWidth"):(this.proxyImage=new Image,this.proxyImage.addEventListener("load",this),this.proxyImage.addEventListener("error",this),this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.proxyImage.src=this.img.src)},i.prototype.getIsImageComplete=function(){return this.img.complete&&this.img.naturalWidth},i.prototype.confirm=function(t,e){this.isLoaded=t,this.emitEvent("progress",[this,this.img,e])},i.prototype.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},i.prototype.onload=function(){this.confirm(!0,"onload"),this.unbindEvents()},i.prototype.onerror=function(){this.confirm(!1,"onerror"),this.unbindEvents()},i.prototype.unbindEvents=function(){this.proxyImage.removeEventListener("load",this),this.proxyImage.removeEventListener("error",this),this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},(o.prototype=Object.create(i.prototype)).check=function(){this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.img.src=this.url,this.getIsImageComplete()&&(this.confirm(0!==this.img.naturalWidth,"naturalWidth"),this.unbindEvents())},o.prototype.unbindEvents=function(){this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},o.prototype.confirm=function(t,e){this.isLoaded=t,this.emitEvent("progress",[this,this.element,e])},(l.makeJQueryPlugin=function(t){(t=t||e.jQuery)&&((n=t).fn.imagesLoaded=function(t,e){return new l(this,t,e).jqDeferred.promise(n(this))})})(),l})},{"ev-emitter":38}],40:[function(t,i,e){!function(o){!function(){var t,e;t=this,e=function(){var e,I="object"==typeof self&&self.self===self&&self||"object"==typeof o&&o.global===o&&o||this,R=I.document;function i(a,d){"use strict";function e(){}var s,t,n={},r={},p=(d=d||{}).auto||0,i=!1,u=function(t){setTimeout(t||e,0)},c={addEventListener:!!I.addEventListener,touch:"ontouchstart"in I||I.DocumentTouch&&R instanceof DocumentTouch,transitions:function(t){var e,i=["transitionProperty","WebkitTransition","MozTransition","OTransition","msTransition"];for(e in i)if(void 0!==t.style[i[e]])return!0;return!1}(R.createElement("swipe"))};if(a){var f,g,m,h,v=a.children[0],b=parseInt(d.startSlide,10)||0,w=d.speed||300;d.continuous=void 0===d.continuous||d.continuous;var o,l,y=(o="direction",a.currentStyle?l=a.currentStyle[o]:I.getComputedStyle&&(l=I.getComputedStyle(a,null).getPropertyValue(o)),"rtl"===l?"right":"left");d.autoRestart=void 0!==d.autoRestart&&d.autoRestart;var _=function(i,o){o=o||100;var s=null;function n(){s&&clearTimeout(s)}function t(){var t=this,e=arguments;n(),s=setTimeout(function(){s=null,i.apply(t,e)},o)}return t.cancel=n,t}(k),$={handleEvent:function(t){if(!i){switch(t.type){case"mousedown":case"touchstart":this.start(t);break;case"mousemove":case"touchmove":this.move(t);break;case"mouseup":case"mouseleave":case"touchend":this.end(t);break;case"webkitTransitionEnd":case"msTransitionEnd":case"oTransitionEnd":case"otransitionend":case"transitionend":this.transitionEnd(t);break;case"resize":_()}d.stopPropagation&&t.stopPropagation()}},start:function(t){var e;O(t)?(e=t).preventDefault():e=t.touches[0],n={x:e.pageX,y:e.pageY,time:+new Date},s=void 0,r={},O(t)?(v.addEventListener("mousemove",this,!1),v.addEventListener("mouseup",this,!1),v.addEventListener("mouseleave",this,!1)):(v.addEventListener("touchmove",this,!1),v.addEventListener("touchend",this,!1))},move:function(t){var e;if(O(t))e=t;else{if(1<t.touches.length||t.scale&&1!==t.scale)return;d.disableScroll&&t.preventDefault(),e=t.touches[0]}r={x:e.pageX-n.x,y:e.pageY-n.y},(s=void 0===s?!!(s||Math.abs(r.x)<Math.abs(r.y)):s)||(t.preventDefault(),L(),d.continuous?(P(A(b-1),r.x+g[A(b-1)],0),P(b,r.x+g[b],0),P(A(b+1),r.x+g[A(b+1)],0)):(r.x=r.x/(!b&&0<r.x||b===f.length-1&&r.x<0?Math.abs(r.x)/m+1:1),P(b-1,r.x+g[b-1],0),P(b,r.x+g[b],0),P(b+1,r.x+g[b+1],0)))},end:function(t){var e=+new Date-n.time,i=Number(e)<250&&20<Math.abs(r.x)||Math.abs(r.x)>m/2,o=!b&&0<r.x||b===f.length-1&&r.x<0;d.continuous&&(o=!1);e=Math.abs(r.x)/r.x;s||(i&&!o?(b=e<0?(d.continuous?(Q(A(b-1),-m,0),Q(A(b+2),m,0)):Q(b-1,-m,0),Q(b,g[b]-m,w),Q(A(b+1),g[A(b+1)]-m,w),A(b+1)):(d.continuous?(Q(A(b+1),m,0),Q(A(b-2),-m,0)):Q(b+1,m,0),Q(b,g[b]+m,w),Q(A(b-1),g[A(b-1)]+m,w),A(b-1)),D(T(),f[b],e)):d.continuous?(Q(A(b-1),-m,w),Q(b,0,w),Q(A(b+1),m,w)):(Q(b-1,-m,w),Q(b,0,w),Q(b+1,m,w))),O(t)?(v.removeEventListener("mousemove",$,!1),v.removeEventListener("mouseup",$,!1),v.removeEventListener("mouseleave",$,!1)):(v.removeEventListener("touchmove",$,!1),v.removeEventListener("touchend",$,!1))},transitionEnd:function(t){parseInt(t.target.getAttribute("data-index"),10)===b&&((p||d.autoRestart)&&S(),M(T(),f[b]))}};return k(),F(),{setup:k,slide:function(t,e){L(),E(t,e)},prev:function(){L(),i||(d.continuous||b)&&E(b-1)},next:function(){L(),C()},restart:S,stop:L,getPos:T,disable:function(){L(),i=!0},enable:function(){i=!1,S()},getNumSlides:function(){return h},kill:function(){L(),a.style.visibility="",v.style.width="",v.style[y]="";var t=f.length;for(;t--;){c.transitions&&P(t,0,0);var e=f[t];e.getAttribute("data-cloned")&&e.parentElement.removeChild(e),e.style.width="",e.style[y]="",e.style.webkitTransitionDuration=e.style.MozTransitionDuration=e.style.msTransitionDuration=e.style.OTransitionDuration=e.style.transitionDuration="",e.style.webkitTransform=e.style.msTransform=e.style.MozTransform=e.style.OTransform=""}x(),_.cancel()}}}function x(){c.addEventListener?(v.removeEventListener("touchstart",$,!1),v.removeEventListener("mousedown",$,!1),v.removeEventListener("webkitTransitionEnd",$,!1),v.removeEventListener("msTransitionEnd",$,!1),v.removeEventListener("oTransitionEnd",$,!1),v.removeEventListener("otransitionend",$,!1),v.removeEventListener("transitionend",$,!1),I.removeEventListener("resize",$,!1)):I.onresize=null}function j(t){t=t.cloneNode(!0);v.appendChild(t),t.setAttribute("data-cloned",!0),t.removeAttribute("id")}function k(t){if(null!=t)for(var e in t)d[e]=t[e];f=v.children,h=f.length;for(var i=0;i<f.length;i++)f[i].getAttribute("data-cloned")&&h--;if(f.length<2&&(d.continuous=!1),c.transitions&&d.continuous&&f.length<3&&(j(f[0]),j(f[1]),f=v.children),"right"===y)for(var o=0;o<f.length;o++)f[o].style.float="right";g=new Array(f.length),m=a.getBoundingClientRect().width||a.offsetWidth,v.style.width=f.length*m*2+"px";for(var s=f.length;s--;){var n=f[s];n.style.width=m+"px",n.setAttribute("data-index",s),c.transitions&&(n.style[y]=s*-m+"px",Q(s,s<b?-m:b<s?m:0,0))}d.continuous&&c.transitions&&(Q(A(b-1),-m,0),Q(A(b+1),m,0)),c.transitions||(v.style[y]=b*-m+"px"),a.style.visibility="visible",x(),c.addEventListener?(c.touch&&v.addEventListener("touchstart",$,!1),d.draggable&&v.addEventListener("mousedown",$,!1),c.transitions&&(v.addEventListener("webkitTransitionEnd",$,!1),v.addEventListener("msTransitionEnd",$,!1),v.addEventListener("oTransitionEnd",$,!1),v.addEventListener("otransitionend",$,!1),v.addEventListener("transitionend",$,!1)),I.addEventListener("resize",$,!1)):I.onresize=_}function C(){i||(d.continuous||b<f.length-1)&&E(b+1)}function D(t,e,i){d.callback&&d.callback(t,e,i)}function M(t,e){d.transitionEnd&&d.transitionEnd(t,e)}function A(t){return(f.length+t%f.length)%f.length}function T(){var t=b;return h<=t&&(t-=h),t}function E(t,e){if(t="number"!=typeof t?parseInt(t,10):t,b!==t){if(c.transitions){var i,o=Math.abs(b-t)/(b-t);d.continuous&&(i=o,(o=-g[A(t)]/m)!==i&&(t=-o*f.length+t));for(var s=Math.abs(b-t)-1;s--;)Q(A((b<t?t:b)-s-1),m*o,0);t=A(t),Q(b,m*o,e||w),Q(t,0,e||w),d.continuous&&Q(A(t-o),-m*o,0)}else t=A(t),n=b*-m,a=t*-m,(r=e||w)?(h=+new Date,l=setInterval(function(){var t=+new Date-h;if(r<t)return v.style[y]=a+"px",(p||d.autoRestart)&&S(),M(T(),f[b]),void clearInterval(l);v.style[y]=(a-n)*(Math.floor(t/r*100)/100)+n+"px"},4)):v.style[y]=a+"px";var n,a,r,h,l;b=t,u(function(){D(T(),f[b],o)})}}function Q(t,e,i){P(t,e,i),g[t]=e}function P(t,e,i){t=f[t],t=t&&t.style;t&&(t.webkitTransitionDuration=t.MozTransitionDuration=t.msTransitionDuration=t.OTransitionDuration=t.transitionDuration=i+"ms",t.webkitTransform="translate("+e+"px,0)translateZ(0)",t.msTransform=t.MozTransform=t.OTransform="translateX("+e+"px)")}function F(){(p=d.auto||0)&&(t=setTimeout(C,p))}function L(){p=0,clearTimeout(t)}function S(){L(),F()}function O(t){return/^mouse/.test(t.type)}}return(I.jQuery||I.Zepto)&&((e=I.jQuery||I.Zepto).fn.Swipe=function(t){return this.each(function(){e(this).data("Swipe",new i(e(this)[0],t))})}),i},"function"==typeof define&&define.amd?define([],function(){return t.Swipe=e(),t.Swipe}):"object"==typeof i&&i.exports?i.exports=e():t.Swipe=e()}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[16]);